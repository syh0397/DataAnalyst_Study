# S Q L

## ğŸ”¥Â ì¼ìë³„ CHECK (ì£¼ì°¨ë³„ í† ê¸€) ğŸ”¥

- ì¼ìë³„ ì²´í¬ 1ì£¼ì°¨
    
    
    |  | ì›” | í™” | ìˆ˜ | ëª© | ê¸ˆ | í†  | ì¼ |
    | --- | --- | --- | --- | --- | --- | --- | --- |
    | ê¹€ì„ ê¸° |  |  |  |  |  | ğŸ”¥ | ğŸ”¥ |
    | ê¹€ì§€í˜¸ |  |  |  |  |  | ğŸ”¥ | ğŸ”¥ |
    | ë¥˜íƒœê·œ |  |  |  |  |  |  |  |
    | ì„¤ìœ í™˜ |  |  |  |  |  | ğŸ”¥ |  |
    | ì´ì• í˜„ |  |  |  |  | ğŸ”¥ | ğŸ”¥ | ğŸ”¥ |
    | ì„ì •ì„ |  |  |  |  | ğŸ”¥ | ğŸ”¥ | ğŸ”¥ |
    | ì •ì§€í˜œ |  |  |  |  | ğŸ”¥ | ğŸ”¥ |  |
    | ì¡°ì„¸í™” |  |  |  |  |  | ğŸ”¥ | ğŸ”¥ |
    | í•œê·œì§„ |  |  |  |  |  | ğŸ”¥ | ğŸ”¥ |
    |  |  |  |  |  |  |  |  |
- ì¼ìë³„ ì²´í¬ 2ì£¼ì°¨
    
    
    |  | ì›” | í™” | ìˆ˜ | ëª© | ê¸ˆ | í†  | ì¼ |
    | --- | --- | --- | --- | --- | --- | --- | --- |
    | ê¹€ì„ ê¸° | ğŸ”¥ |  | ğŸ”¥ |  |  |  |  |
    | ê¹€ì§€í˜¸ | ğŸ”¥ | ğŸ”¥ | ğŸ”¥ |  |  |  |  |
    | ë¥˜íƒœê·œ | ğŸ”¥ | ğŸ”¥ | ğŸ”¥ |  |  |  |  |
    | ì„¤ìœ í™˜ | ğŸ”¥ |  | ğŸ”¥ |  |  |  |  |
    | ì´ì• í˜„ | ğŸ”¥ | ğŸ”¥ | ğŸ”¥ |  |  |  |  |
    | ì„ì •ì„ | ğŸ”¥ | ğŸ”¥ | ğŸ”¥ |  |  |  |  |
    | ì •ì§€í˜œ | ğŸ”¥ | ğŸ”¥ | ğŸ”¥ |  |  |  |  |
    | ì¡°ì„¸í™” | ğŸ”¥ | ğŸ”¥ | ğŸ”¥ |  |  |  |  |
    | í•œê·œì§„ | ğŸ”¥ |  | ğŸ”¥ |  |  |  |  |
    |  | ì „ì› |  | ì „ì› |  |  |  |  |
- ì¼ìë³„ ì²´í¬ 3ì£¼ì°¨
    
    
    |  | ì›” | í™” | ìˆ˜ | ëª© | ê¸ˆ | í†  | ì¼ |
    | --- | --- | --- | --- | --- | --- | --- | --- |
    | ê¹€ì„ ê¸° |  |  |  |  |  |  |  |
    | ê¹€ì§€í˜¸ |  |  |  |  |  |  |  |
    | ë¥˜íƒœê·œ |  |  |  |  |  |  |  |
    | ì„¤ìœ í™˜ |  |  |  |  |  |  |  |
    | ì´ì• í˜„ |  |  |  |  |  |  |  |
    | ì„ì •ì„ |  |  |  |  |  |  |  |
    | ì •ì§€í˜œ |  |  |  |  |  |  |  |
    | ì¡°ì„¸í™” |  |  |  |  |  |  |  |
    | í•œê·œì§„ |  |  |  |  |  |  |  |
    |  |  |  |  |  |  |  |  |
- ì¼ìë³„ ì²´í¬ 4ì£¼ì°¨
    
    
    |  | ì›” | í™” | ìˆ˜ | ëª© | ê¸ˆ | í†  | ì¼ |
    | --- | --- | --- | --- | --- | --- | --- | --- |
    | ê¹€ì„ ê¸° |  |  |  |  |  |  |  |
    | ê¹€ì§€í˜¸ |  |  |  |  |  |  |  |
    | ë¥˜íƒœê·œ |  |  |  |  |  |  |  |
    | ì„¤ìœ í™˜ |  |  |  |  |  |  |  |
    | ì´ì• í˜„ |  |  |  |  |  |  |  |
    | ì„ì •ì„ |  |  |  |  |  |  |  |
    | ì •ì§€í˜œ |  |  |  |  |  |  |  |
    | ì¡°ì„¸í™” |  |  |  |  |  |  |  |
    | í•œê·œì§„ |  |  |  |  |  |  |  |
    |  |  |  |  |  |  |  |  |
- ì¼ìë³„ ì²´í¬ 5ì£¼ì°¨
    
    
    |  | ì›” | í™” | ìˆ˜ | ëª© | ê¸ˆ | í†  | ì¼ |
    | --- | --- | --- | --- | --- | --- | --- | --- |
    | ê¹€ì„ ê¸° |  |  |  |  |  |  |  |
    | ê¹€ì§€í˜¸ |  |  |  |  |  |  |  |
    | ë¥˜íƒœê·œ |  |  |  |  |  |  |  |
    | ì„¤ìœ í™˜ |  |  |  |  |  |  |  |
    | ì´ì• í˜„ |  |  |  |  |  |  |  |
    | ì„ì •ì„ |  |  |  |  |  |  |  |
    | ì •ì§€í˜œ |  |  |  |  |  |  |  |
    | ì¡°ì„¸í™” |  |  |  |  |  |  |  |
    | í•œê·œì§„ |  |  |  |  |  |  |  |
    |  |  |  |  |  |  |  |  |
- ì¼ìë³„ ì²´í¬ 6ì£¼ì°¨
    
    
    |  | ì›” | í™” | ìˆ˜ | ëª© | ê¸ˆ | í†  | ì¼ |
    | --- | --- | --- | --- | --- | --- | --- | --- |
    | ê¹€ì„ ê¸° |  |  |  |  |  |  |  |
    | ê¹€ì§€í˜¸ |  |  |  |  |  |  |  |
    | ë¥˜íƒœê·œ |  |  |  |  |  |  |  |
    | ì„¤ìœ í™˜ |  |  |  |  |  |  |  |
    | ì´ì• í˜„ |  |  |  |  |  |  |  |
    | ì„ì •ì„ |  |  |  |  |  |  |  |
    | ì •ì§€í˜œ |  |  |  |  |  |  |  |
    | ì¡°ì„¸í™” |  |  |  |  |  |  |  |
    | í•œê·œì§„ |  |  |  |  |  |  |  |
    |  |  |  |  |  |  |  |  |
- ì¼ìë³„ ì²´í¬ 7ì£¼ì°¨
    
    
    |  | ì›” | í™” | ìˆ˜ | ëª© | ê¸ˆ | í†  | ì¼ |
    | --- | --- | --- | --- | --- | --- | --- | --- |
    | ê¹€ì„ ê¸° |  |  |  |  |  |  |  |
    | ê¹€ì§€í˜¸ |  |  |  |  |  |  |  |
    | ë¥˜íƒœê·œ |  |  |  |  |  |  |  |
    | ì„¤ìœ í™˜ |  |  |  |  |  |  |  |
    | ì´ì• í˜„ |  |  |  |  |  |  |  |
    | ì„ì •ì„ |  |  |  |  |  |  |  |
    | ì •ì§€í˜œ |  |  |  |  |  |  |  |
    | ì¡°ì„¸í™” |  |  |  |  |  |  |  |
    | í•œê·œì§„ |  |  |  |  |  |  |  |
    |  |  |  |  |  |  |  |  |
- ì¼ìë³„ ì²´í¬ 8ì£¼ì°¨
    
    
    |  | ì›” | í™” | ìˆ˜ | ëª© | ê¸ˆ | í†  | ì¼ |
    | --- | --- | --- | --- | --- | --- | --- | --- |
    | ê¹€ì„ ê¸° |  |  |  |  |  |  |  |
    | ê¹€ì§€í˜¸ |  |  |  |  |  |  |  |
    | ë¥˜íƒœê·œ |  |  |  |  |  |  |  |
    | ì„¤ìœ í™˜ |  |  |  |  |  |  |  |
    | ì´ì• í˜„ |  |  |  |  |  |  |  |
    | ì„ì •ì„ |  |  |  |  |  |  |  |
    | ì •ì§€í˜œ |  |  |  |  |  |  |  |
    | ì¡°ì„¸í™” |  |  |  |  |  |  |  |
    | í•œê·œì§„ |  |  |  |  |  |  |  |
    |  |  |  |  |  |  |  |  |

# ğŸ“Œ **ë¨¼ì € ì½ì–´ë³¼ ë§í¬ ì •ë¦¬**

- **`ë¨¼ì € ì½ì–´ë³¼ ë§í¬ ì •ë¦¬ ì…ë‹ˆë‹¤.`  ê¼­ ì½ì–´ë³´ì„¸ìš” !!!**
    - ê°€ì¥ ì¤‘ìš”í•œ ë°ì´í„°ëŠ” ì´ë¯¸ ë‚´ë¶€ì— ìˆë‹¤
    
    [https://publy.co/content/433?utm_source=brunch_minu&utm_medium=brunch_minu&utm_content=data_sql](https://publy.co/content/433?utm_source=brunch_minu&utm_medium=brunch_minu&utm_content=data_sql) 
    
    - ë°ì´í„° ë¶„ì„, SQLë§Œ ì˜ ë‹¤ë¤„ë„ ë¨¹ê³  ë“¤ì–´ê°‘ë‹ˆë‹¤.
    
    [https://brunch.co.kr/@minu-log/4](https://brunch.co.kr/@minu-log/4)
    
    - ë°ì´í„° ë¶„ì„, ë¨¹ê³  ë“¤ì–´ê°€ê¸° ìœ„í•œ SQL ê³µë¶€ë²•(1í¸)
    
    [https://brunch.co.kr/@minu-log/5](https://brunch.co.kr/@minu-log/5)ã„±
    

---

---

## 1. SQL ê³µë¶€ìˆœì„œ (ììœ¨ ê³µë¶€(ì‹¤ì „ë¬¸ì œ) -  (repo / í€´ì¦ˆ / í† ë¡ )

- ê¹ƒí—™ ë ˆí¬ ì •ë¦¬ reference
    
    [https://github.com/JessyMin/SQL-recipe-book-practice/blob/master/11_finding_patterns_of_users.md](https://github.com/JessyMin/SQL-recipe-book-practice/blob/master/11_finding_patterns_of_users.md)
    

## 2. ê¹ƒí—™ ë ˆí¬ ì •ë¦¬ì‹œ ì°¸ê³  ì‚¬í•­

- ì¶”ê°€ì ìœ¼ë¡œ 'ë¯¸ë‹ˆ' í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ì œì‘í•©ë‹ˆë‹¤. (Code_ì†ë‹¨ì•„ ë‹˜ì˜ ì¶”ì²œ)
    
    ë¬¸ì œì œê¸° :  ex ) ì¹´í…Œê³ ë¦¬ë³„ë¡œ ë§¤ì¶œê³¼ ì†Œê³„ë¥¼ ê³„ì‚°í•˜ê¸° 
    ë‚´ê°€ í’€ê³ ì í•˜ëŠ” ë°©í–¥ :
    ~~~~ì‹¤ì œ ì‚¬ìš©í•œ ì¿¼ë¦¬ :
    ë¶„ì„ ê²°ê³¼ :
    ~~~~ì¸ì‚¬ì´íŠ¸ :
    

```sql
-- ì—°ìŠµí•  DBëŠ” ì œê³µí•´ ë“œë¦½ë‹ˆë‹¤. 
-- í€´ì¦ˆëŠ” ë‹¤ë¥¸ DBë¥¼ í†µí•´ ì§„í–‰í•©ë‹ˆë‹¤. 
```

[1ì£¼ì°¨ ë°°ìš¸ ëª©ë¡ 8.02 ~ 8.06](https://www.notion.so/1-8-02-8-06-1efe26d94e774b1aa2ccf99660f9bd82)

[2ì£¼ì°¨ ë°°ìš¸ ëª©ë¡ 8.09 ~ 8.13](https://www.notion.so/2-8-09-8-13-b769537c3a7b408598231f67daa0277f)

[3ì£¼ì°¨ ë°°ìš¸ ëª©ë¡ 8.16 ~ 8.20](https://www.notion.so/3-8-16-8-20-6275cbb4b12b47ebb30e0199f2783c4f)

[4ì£¼ì°¨ - 8.23 ~ í”„ë¡œê·¸ë˜ë¨¸ìŠ¤ ë¬¸ì œ í’€ê¸°](https://www.notion.so/4-8-23-b24ea9baa9c94217851daf0f18d39aa8)

---

## 1.  3ì£¼ì°¨ ê¹Œì§€ ê°ì SQLì€ ì–´ë””ì„œ ì–´ë–»ê²Œ ë°°ìš°ë“  ìƒê´€ì—†ìŠµë‹ˆë‹¤.

<aside>
ğŸ“ ì•„ë˜ ë§í¬ëŠ” ë°°ìš¸ë§Œí•œ ê³³ ì…ë‹ˆë‹¤. LINK

</aside>

- ë°°ìš¸ë§Œí•œ ë§í¬ 3ê°œ
    
    > Introduction to SQL for Data Science (DataCamp)
    > 
    - [https://www.datacamp.com/courses/introduction-to-sql](https://www.datacamp.com/courses/introduction-to-sql)
    
    > SQL Fundamentals (SOLOLEARN)
    > 
    - [https://www.sololearn.com/learning/1060](https://www.sololearn.com/learning/1060)
    
    > The SQL Tutorial for Data Analysis (Mode Analytics)
    > 
    - [https://mode.com/sql-tutorial/introduction-to-sql/](https://mode.com/sql-tutorial/introduction-to-sql/)
- +  ì¶”ê°€ ë°°ìš¸ë§Œí•œ ëª©ë¡ 3ê°œ (^^)
    
    **(1) ë¬¸ë²• ìì²´ ê³µë¶€í•˜ê¸°: ì±… ë˜ëŠ” ì˜¨ë¼ì¸ ê°•ì¢Œ.**
    
    ë¬¸ë²• ìì²´ë¥¼ ê³µë¶€í•˜ê¸°ì—ëŠ” ì±… ë˜ëŠ” ì˜¨ë¼ì¸ ê°•ì¢Œê°€ ì¢‹ìŠµë‹ˆë‹¤. ë‹¤ë§Œ ì•ì—ì„œ ë§ì”€ë“œë¦° ê²ƒì²˜ëŸ¼ 'ì—”ì§€ë‹ˆì–´'ë¥¼ ìœ„í•œ ì±…ê³¼ ê°•ì¢Œê°€ ë‹¤ìˆ˜ì¸ ë§Œí¼, ìë£Œë¥¼ ì˜ ê±¸ëŸ¬ë‚´ëŠ” ê²ƒë§Œ í•´ë„ ë¶€ë‹´ìŠ¤ëŸ¬ìš´ ì¼ì…ë‹ˆë‹¤. ê·¸ë˜ì„œ ì“¸ë§Œí•œ ìë£Œë¥¼ ëª‡ ê°œ ì¶”ì²œí•´ ë“œê² ìŠµë‹ˆë‹¤.
    
    ### **1) ì±…:Â [ì¹¼í‡´ì¡± ê¹€ëŒ€ë¦¬ëŠ” ì•Œê³  ë‚˜ë§Œ ëª¨ë¥´ëŠ” SQL ê¸°ì´ˆí¸](http://book.naver.com/bookdb/book_detail.nhn?bid=8073252)**
    
    ì´ì „ ê¸€ì—ì„œ ì–¸ê¸‰í–ˆë˜ ì˜ì¹´(SOCAR)ì˜ ë§ˆì¼€í„° ëª‡ ë¶„ì€ ì´ ì±…ìœ¼ë¡œ SQL ê¸°ë³¸ ë¬¸ë²•ì„ ê³µë¶€í–ˆìŠµë‹ˆë‹¤. (ì˜ì¹´ì—ì„œëŠ” ê±°ì˜ ë² ìŠ¤íŠ¸ì…€ëŸ¬ ê¸‰ì´ì—ˆìŠµë‹ˆë‹¤. ì‚¬ë¬´ì‹¤ì— ì´ ì±…ë§Œ 6ê¶Œ ì´ìƒ ìˆì—ˆìŠµë‹ˆë‹¤.)'ê¸°ì´ˆí¸'ì´ ìˆìœ¼ë‹ˆ 'ì¤‘ê¸‰í¸', 'ì‹¬í™”í¸'ë„ ìˆì–´ì•¼ í•  ê²ƒë§Œ ê°™ì§€ë§Œ, í›„ì†ì‘ì€ ë‚˜ì˜¤ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
    
    [https://t1.daumcdn.net/thumb/R1280x0/?fname=http://t1.daumcdn.net/brunch/service/user/16ei/image/v7H1gejrOIcMl9DKnGecigOuxHY.png](https://t1.daumcdn.net/thumb/R1280x0/?fname=http://t1.daumcdn.net/brunch/service/user/16ei/image/v7H1gejrOIcMl9DKnGecigOuxHY.png)
    
    - ì¥ì :Â **ëª‡ ì•ˆ ë˜ëŠ” ìš°ë¦¬ë§ ìë£Œì…ë‹ˆë‹¤.**Â ë§ˆì§€ë§‰ í•œ ì±•í„°ë¥¼ ì œì™¸í•˜ë©´ ë¶„ì„ê³¼ ë¬´ê´€í•œ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.
    - ë‹¨ì : ì•„ë˜ ì—´ê±°í•  ì˜¨ë¼ì¸ ê°•ì¢Œì™€ ë‹¬ë¦¬, ì‹¤ìŠµì„ ìœ„í•œ í™˜ê²½ì„ ì œê³µí•˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.
    
    ### **2) ë¬´ë£Œ ì˜¨ë¼ì¸ ê°•ì¢Œ(ì´ˆê¸‰):Â [Introduction to SQL for Data Science (DataCamp)](https://www.datacamp.com/courses/intro-to-sql-for-data-science)**
    
    - 2019ë…„ 3ì›” ê¸°ì¤€ìœ¼ë¡œ, ì´ ê°•ì˜ëŠ” ìœ ë£Œ ê°•ì˜ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ì›” ì•½ 30ë‹¬ëŸ¬ ì •ë„ì˜ ê°€ê²©ìœ¼ë¡œ ë°ì´í„°ìº í”„ì˜ ëª¨ë“  ê°•ì˜ë¥¼ ìˆ˜ê°•í•˜ì‹¤ ìˆ˜ ìˆìœ¼ë‹ˆ, í° ë¶€ë‹´ì€ ì•„ë‹ˆì‹¤ ê±°ë¼ ìƒê°í•©ë‹ˆë‹¤. :)
    
    ë°ì´í„° ë¶„ì„ì„ ìœ„í•œ ê°ì¢… ê°•ì¢Œë“¤ì´ ëª¨ì—¬ ìˆëŠ” DataCampì˜ SQL ê°•ì¢Œì…ë‹ˆë‹¤. SELECT, filtering, grouping, sorting ë“± ê¸°ì´ˆì ì¸ ë‚´ìš©ì„ ë‹¤ë£¹ë‹ˆë‹¤. íšŒì› ê°€ì…ì„ í•´ì•¼ ì´ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ë¬´ë£Œ ê°•ì¢Œì…ë‹ˆë‹¤.
    
    [https://t1.daumcdn.net/thumb/R1280x0/?fname=http://t1.daumcdn.net/brunch/service/user/16ei/image/Q2FA97DavptlMIoAAQqC5qXGLTM.png](https://t1.daumcdn.net/thumb/R1280x0/?fname=http://t1.daumcdn.net/brunch/service/user/16ei/image/Q2FA97DavptlMIoAAQqC5qXGLTM.png)
    
    ì´ëŸ° ì‹ìœ¼ë¡œ ë°°ìš´ ë‚´ìš©ì„ ì›¹ë¸Œë¼ìš°ì €ì—ì„œ ë°”ë¡œ ì‹¤ìŠµí•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤.
    
    - ì¥ì : ë¯¿ê³  ë³´ëŠ” DataCamp ê°•ì¢Œì…ë‹ˆë‹¤. DataCampëŠ” ì˜¨ë¼ì¸ ê°•ì¢Œ ì „ë¬¸ ì—…ì²´ì´ê¸° ë•Œë¬¸ì—, í•™ìŠµì„ ìœ„í•œ ì¸í„°í˜ì´ìŠ¤ê°€ ì˜ ë§Œë“¤ì–´ì ¸ ìˆìŠµë‹ˆë‹¤. ì°¨ê·¼ì°¨ê·¼ ì‹¤ìŠµì„ í•˜ë©° í•¨ê»˜ ê°•ì˜ë¥¼ ë”°ë¼ê°€ë‹¤ ë³´ë©´ ê¸°ë³¸ SQL ë¬¸ë²•ì„ ìµí ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - ë‹¨ì : êµ³ì´ ê¼½ìë©´, ì˜ì–´ ê°•ì¢Œë¼ëŠ” ì ? (ê·¸ë ‡ì§€ë§Œ ê¸°ìˆ ì ì¸ ë‚´ìš©ì„ ê³µë¶€í•  ë•Œ ì˜ì–´ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.)
    
    ### **3) ë¬´ë£Œ ì˜¨ë¼ì¸ ê°•ì¢Œ(ì´ˆê¸‰~ê³ ê¸‰):Â [The SQL Tutorial for Data Analysis (Mode Analytics)](https://community.modeanalytics.com/sql/tutorial/introduction-to-sql/)**
    
    ë°ì´í„° ë¶„ì„ ì†”ë£¨ì…˜ ì—…ì²´ì¸ Mode Analyticsì—ì„œ ì œê³µí•˜ëŠ” ê°•ì¢Œì…ë‹ˆë‹¤. ì‹¤ì œë¡œ ì‹¤ìŠµì„ í•˜ë ¤ë©´ ê³„ì •ì„ ë§Œë“¤ì–´ì•¼ í•˜ì§€ë§Œ, ê°•ì¢Œ ìì²´ëŠ” ë¡œê·¸ì¸ ì—†ì´ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
    [https://t1.daumcdn.net/thumb/R1280x0/?fname=http://t1.daumcdn.net/brunch/service/user/16ei/image/59TmoZxcjyWSRgh75NiuLTixhc0.png](https://t1.daumcdn.net/thumb/R1280x0/?fname=http://t1.daumcdn.net/brunch/service/user/16ei/image/59TmoZxcjyWSRgh75NiuLTixhc0.png)
    
    - ì¥ì : ì´ˆê¸‰, ì¤‘ê¸‰, ê³ ê¸‰ ìˆ˜ì¤€ë³„ë¡œ SQL ë¬¸ë²•ì„ ì˜ ì„¤ëª…í•´ ë†“ì•˜ìŠµë‹ˆë‹¤. ì—¬ê¸°ì— ìˆëŠ” ë‚´ìš©ë§Œ ì˜ ê³µë¶€í•´ ë‘ë©´ ì–´ë”” ê°€ì„œ SQL ì¢€ í•œë‹¤ê³  ìë‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - ë‹¨ì :Â ê°•ì¢Œ ì „ë¬¸ ì„œë¹„ìŠ¤ê°€ ì•„ë‹ˆë‹ˆ, DataCampì²˜ëŸ¼ ì¹œì ˆí•œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê¸°ëŒ€í•˜ê¸°ëŠ” ì–´ë µìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ìì‹ ë“¤ì˜ ì„œë¹„ìŠ¤(Mode Analytics)ë¥¼ í™ë³´í•˜ëŠ” ëª©ì ë„ ìˆì–´ì„œ, ì¤‘ê°„ì¤‘ê°„ Mode Analyticsì—ë§Œ ì ìš©ë˜ëŠ” ë‚´ìš©ì´ ë‚˜ì˜¤ê¸°ë„ í•©ë‹ˆë‹¤. ê·¸ë˜ë„ í¬ê²Œ ê±°ìŠ¬ë¦¬ê±°ë‚˜ í•™ìŠµì— ë°©í•´ë  ì •ë„ëŠ” ì•„ë‹™ë‹ˆë‹¤.
- ì¸í”„ëŸ° - [SQL-ì¸ì ì…˜-ê³µê²©-ê¸°ë³¸-ë¬¸ë²•](https://www.inflearn.com/course/SQL-%EC%9D%B8%EC%A0%9D%EC%85%98-%EA%B3%B5%EA%B2%A9-%EA%B8%B0%EB%B3%B8-%EB%AC%B8%EB%B2%95#reviews)
    
    [https://www.inflearn.com/course/SQL-ì¸ì ì…˜-ê³µê²©-ê¸°ë³¸-ë¬¸ë²•#reviews](https://www.inflearn.com/course/SQL-%EC%9D%B8%EC%A0%9D%EC%85%98-%EA%B3%B5%EA%B2%A9-%EA%B8%B0%EB%B3%B8-%EB%AC%B8%EB%B2%95#reviews)
    

---

## 2. **ê°ì ê³µë¶€ë¥¼ ì§„í–‰í•˜ê³  í€´ì¦ˆë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.** + í† ,ì¼ ì¤‘ ëª¨ì—¬ í”¼ë“œë°± & ì˜ë…¼

í€´ì¦ˆëŠ” ê¸ˆìš”ì¼ì— ì˜¬ë ¤ë“œë¦½ë‹ˆë‹¤.  /  ì¼ìš”ì¼ì— ì •ë‹µì„ ì˜¬ë ¤ë“œë¦½ë‹ˆë‹¤.(ê·¸ í›„ ì¹´í†¡ë°©ì— ê³µì§€í•´ ë“œë¦½ë‹ˆë‹¤ ! ) 

```sql
í”¼ë“œë°± ì˜ˆì‹œ -- (ë‹¨ìˆœ ì˜ˆì‹œì…ë‹ˆë‹¤. ë°”ê¾¸ì…”ë„ ë©ë‹ˆë‹¤.)
=>  ê°€ë…ì„±ì´ ì¢‹ì€ê°€? 
=>  ì¢‹ì§€ ì•Šë‹¤ë©´ ë¬´ì—‡ì„ ë” ì¶”ê°€í•´ì•¼ í•˜ëŠ”ê°€? ì–´ë–»ê²Œ ì‘ì„±í•´ì•¼ í•˜ëŠ”ê°€?
=>  ë” ì¢‹ì€ ë°©ì•ˆì´ ìˆëŠ”ê°€?
=>  ë” ì‰½ê²Œ í‘¸ëŠ” ë°©ë²•ì´ ìˆëŠ”ê°€?
=>  ë‹µì€ ì˜³ê²Œ ë‚˜ì™”ëŠ”ê°€? ë“±ë“±                                                
```

---

# ğŸ“ŒÂ ì‹¤ìŠµí™˜ê²½ Setting

- ì‹¤ìŠµ í™˜ê²½ ì„¸íŒ… ì†Œê°œ - dbeaver ì´ìš© ( ERD í¬í•¨) â‡’ ì—¬ê¸°ì„œ ì„¸íŒ…í•˜ì‹œë©´ ë©ë‹ˆë‹¤
    
    [ìƒ˜í”Œ db [https://www.postgresqltutorial.com/postgresql-sample-database/](https://www.postgresqltutorial.com/postgresql-sample-database/)](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled.zip)
    
    ìƒ˜í”Œ db [https://www.postgresqltutorial.com/postgresql-sample-database/](https://www.postgresqltutorial.com/postgresql-sample-database/)
    
    ![S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled.png](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled.png)
    
    SQL ì¿¼ë¦¬ Tool [https://dbeaver.io/download/](https://dbeaver.io/download/)
    
    ì„¤ì¹˜ ì°¸ê³  ì‚¬ì´íŠ¸
    
    Window : https://3rdscholar.tistory.com/37
    Mac : https://jybaek.tistory.com/858
    
    **DB** ì ‘ì† ë°©ë²•
    
    - ë°ì´í„°ë² ì´ìŠ¤(D) â†’ ìƒˆ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
    
    ![S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%201.png](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%201.png)
    
    ![S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%202.png](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%202.png)
    
    ![S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%203.png](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%203.png)
    
    ë
    
    ![ERD ](S%20Q%20L%20652a8da88475490c9583cc1c305da234/dvd-rental-sample-database-diagram.png)
    
    ERD 
    
- ì‹¤ìŠµ í™˜ê²½ ì„¸íŒ… ì†Œê°œ - Mysql ì´ìš©ì‹œ - (03ê¸° ê¹€ì„ ê¸° ë‹˜ ver 1.0)
    
    [https://dev.mysql.com/downloads/mysql/](https://dev.mysql.com/downloads/mysql/) - mysql ì„¤ì¹˜ í˜ì´ì§€
    
    ![mysql community serverì—ì„œ ë‹¤ìš´ë°›ëŠ”ë‹¤.(íŒ¨í‚¤ì§€)](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%204.png)
    
    mysql community serverì—ì„œ ë‹¤ìš´ë°›ëŠ”ë‹¤.(íŒ¨í‚¤ì§€)
    
    ![ìš©ëŸ‰ì´ ë§ì€ í•­ëª© í´ë¦­í•´ì„œ ë‹¤ìš´ë°›ëŠ”ë‹¤.](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%205.png)
    
    ìš©ëŸ‰ì´ ë§ì€ í•­ëª© í´ë¦­í•´ì„œ ë‹¤ìš´ë°›ëŠ”ë‹¤.
    
    ![Developer Default ì„ íƒ](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%206.png)
    
    Developer Default ì„ íƒ
    
    ![next](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%207.png)
    
    next
    
    ![installationì´ ë‹¤ìŒê³¼ ê°™ì´ ëª©ë¡ì´ ë‚˜ì˜¤ë©´ ëœë‹¤.](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%208.png)
    
    installationì´ ë‹¤ìŒê³¼ ê°™ì´ ëª©ë¡ì´ ë‚˜ì˜¤ë©´ ëœë‹¤.
    
    ![ë„¤íŠ¸ì›Œí¬ë„ ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œ ì§„í–‰](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%209.png)
    
    ë„¤íŠ¸ì›Œí¬ë„ ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œ ì§„í–‰
    
    ![root ë¹„ë°€ë²ˆí˜¸ ì„¤ì • ì›í•˜ëŠ” ë¹„ë°€ë²ˆí˜¸ë¡œ ì„¤ì •í•´ì¤€ë‹¤.](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2010.png)
    
    root ë¹„ë°€ë²ˆí˜¸ ì„¤ì • ì›í•˜ëŠ” ë¹„ë°€ë²ˆí˜¸ë¡œ ì„¤ì •í•´ì¤€ë‹¤.
    
    ![ì„¤ì •í•œ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥í›„ check](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2011.png)
    
    ì„¤ì •í•œ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥í›„ check
    
    ![ì´í›„ ì‹¤í–‰ì„ ì§„í–‰í•˜ë©´ workbenchì™€ í•¨ê»˜ shellì´ ì‹¤í–‰ë˜ë©´ ì •ìƒì‘ë™.](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2012.png)
    
    ì´í›„ ì‹¤í–‰ì„ ì§„í–‰í•˜ë©´ workbenchì™€ í•¨ê»˜ shellì´ ì‹¤í–‰ë˜ë©´ ì •ìƒì‘ë™.
    
    ![workbench main í™”ë©´ì´ scriptì™€ í•¨ê»˜ ë‚˜ì˜¨ë‹¤.](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2013.png)
    
    workbench main í™”ë©´ì´ scriptì™€ í•¨ê»˜ ë‚˜ì˜¨ë‹¤.
    
    ![use sakila ëª…ë ¹ì–´ë¡œ ê¸°ì¡´ ê¹”ë ¤ìˆëŠ” sakila sample dbë¡œ ì ‘ê·¼í•´ì¤€ë‹¤.](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2014.png)
    
    use sakila ëª…ë ¹ì–´ë¡œ ê¸°ì¡´ ê¹”ë ¤ìˆëŠ” sakila sample dbë¡œ ì ‘ê·¼í•´ì¤€ë‹¤.
    
    ![ì¿¼ë¦¬ë¬¸ì„ ì…ë ¥í•´ì£¼ê³  ì •ìƒ ì‘ë™í™•ì¸](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2015.png)
    
    ì¿¼ë¦¬ë¬¸ì„ ì…ë ¥í•´ì£¼ê³  ì •ìƒ ì‘ë™í™•ì¸
    
    EER Diagramì„ í™•ì¸í•˜ê³  ì‹¶ì„ë•Œ
    
    ![Reverse Engineer ì„ íƒ](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2016.png)
    
    Reverse Engineer ì„ íƒ
    
    ![Next](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2017.png)
    
    Next
    
    ![ì›í•˜ëŠ” db ì„ íƒ](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2018.png)
    
    ì›í•˜ëŠ” db ì„ íƒ
    
    ![excute ì§„í–‰](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2019.png)
    
    excute ì§„í–‰
    
    ![ë‹¤ì´ì–´ê·¸ë¨ í™•ì¸ ê°€ëŠ¥](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2020.png)
    
    ë‹¤ì´ì–´ê·¸ë¨ í™•ì¸ ê°€ëŠ¥
    
- DBEAVERë‹¨ì¶•í‚¤
    
    [https://meyouus.tistory.com/52](https://meyouus.tistory.com/52)
    

### 1ì£¼ì°¨ ì‹¤ìŠµë¬¸ì œ

- 1
    
    ë¬¸ì œ1ë²ˆ) dvd ë Œíƒˆ ì—…ì²´ì˜  dvd ëŒ€ì—¬ê°€ ìˆì—ˆë˜ ë‚ ì§œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ2ë²ˆ) ì˜í™”ê¸¸ì´ê°€ 120ë¶„ ì´ìƒì´ë©´ì„œ, ëŒ€ì—¬ê¸°ê°„ì´ 4ì¼ ì´ìƒì´ ê°€ëŠ¥í•œ, ì˜í™”ì œëª©ì„ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ3ë²ˆ) ì§ì›ì˜ id ê°€ 2ë²ˆì¸  ì§ì›ì˜  id, ì´ë¦„, ì„±ì„ ì•Œë ¤ì£¼ì„¸ìš”
    
    ë¬¸ì œ4ë²ˆ) ì§€ë¶ˆ ë‚´ì—­ ì¤‘ì—ì„œ,   ì§€ë¶ˆ ë‚´ì—­ ë²ˆí˜¸ê°€ 17510 ì— í•´ë‹¹í•˜ëŠ”  ,  ê³ ê°ì˜ ì§€ì¶œ ë‚´ì—­ (amount ) ëŠ” ì–¼ë§ˆì¸ê°€ìš”?
    
    ë¬¸ì œ5ë²ˆ) ì˜í™” ì¹´í…Œê³ ë¦¬ ì¤‘ì—ì„œ ,Sci-Fi  ì¹´í…Œê³ ë¦¬ì˜  ì¹´í…Œê³ ë¦¬ ë²ˆí˜¸ëŠ” ëª‡ë²ˆì¸ê°€ìš”?
    
    ë¬¸ì œ6ë²ˆ) film í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬, rating  ë“±ê¸‰(?) ì— ëŒ€í•´ì„œ, ëª‡ê°œì˜ ë“±ê¸‰ì´ ìˆëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”.
    
    ë¬¸ì œ7ë²ˆ) ëŒ€ì—¬ ê¸°ê°„ì´ (íšŒìˆ˜ - ëŒ€ì—¬ì¼) 10ì¼ ì´ìƒì´ì˜€ë˜ rental í…Œì´ë¸”ì— ëŒ€í•œ ëª¨ë“  ì •ë³´ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    ë‹¨ , ëŒ€ì—¬ê¸°ê°„ì€  ëŒ€ì—¬ì¼ìë¶€í„° ëŒ€ì—¬ê¸°ê°„ìœ¼ë¡œ í¬í•¨í•˜ì—¬ ê³„ì‚°í•©ë‹ˆë‹¤.
    
    ë¬¸ì œ8ë²ˆ) ê³ ê°ì˜ id ê°€  50,100,150 ..ë“± 50ë²ˆì˜ ë°°ìˆ˜ì— í•´ë‹¹í•˜ëŠ” ê³ ê°ë“¤ì— ëŒ€í•´ì„œ,
    íšŒì› ê°€ì… ê°ì‚¬ ì´ë²¤íŠ¸ë¥¼ ì§„í–‰í•˜ë ¤ê³ í•©ë‹ˆë‹¤.
    ê³ ê° ì•„ì´ë””ê°€ 50ë²ˆ ë°°ìˆ˜ì¸ ì•„ì´ë””ì™€, ê³ ê°ì˜ ì´ë¦„ (ì„±, ì´ë¦„)ê³¼ ì´ë©”ì¼ì— ëŒ€í•´ì„œ
    í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ9ë²ˆ) ì˜í™” ì œëª©ì˜ ê¸¸ì´ê°€ 8ê¸€ìì¸, ì˜í™” ì œëª© ë¦¬ìŠ¤íŠ¸ë¥¼ ë‚˜ì—´í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ10ë²ˆ)	city í…Œì´ë¸”ì˜ city ê°¯ìˆ˜ëŠ” ëª‡ê°œì¸ê°€ìš”?
    
    ë¬¸ì œ11ë²ˆ)	ì˜í™”ë°°ìš°ì˜ ì´ë¦„ (ì´ë¦„+' '+ì„±) ì— ëŒ€í•´ì„œ,  ëŒ€ë¬¸ìë¡œ ì´ë¦„ì„ ë³´ì—¬ì£¼ì„¸ìš”.  ë‹¨ ê³ ê°ì˜ ì´ë¦„ì´ ë™ì¼í•œ ì‚¬ëŒì´ ìˆë‹¤ë©´,  ì¤‘ë³µ ì œê±°í•˜ê³ , ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ12ë²ˆ)	ê³ ê° ì¤‘ì—ì„œ,  active ìƒíƒœê°€ 0 ì¸ ì¦‰ í˜„ì¬ ì‚¬ìš©í•˜ì§€ ì•Šê³  ìˆëŠ” ê³ ê°ì˜ ìˆ˜ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ13ë²ˆ)	Customer í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬,  store_id = 1 ì— ë§¤í•‘ëœ  ê³ ê°ì˜ ìˆ˜ëŠ” ëª‡ëª…ì¸ì§€ í™•ì¸í•´ë³´ì„¸ìš”.
    
    ë¬¸ì œ14ë²ˆ)	rental í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬,  ê³ ê°ì´ return í–ˆë˜ ë‚ ì§œê°€ 2005ë…„6ì›”20ì¼ì— í•´ë‹¹í–ˆë˜ rental ì˜ ê°¯ìˆ˜ê°€ ëª‡ê°œì˜€ëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”.
    
    ë¬¸ì œ15ë²ˆ)	film í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬, 2006ë…„ì— ì¶œì‹œê°€ ë˜ê³  rating ì´ 'G' ë“±ê¸‰ì— í•´ë‹¹í•˜ë©°, ëŒ€ì—¬ê¸°ê°„ì´ 3ì¼ì— í•´ë‹¹í•˜ëŠ”  ê²ƒì— ëŒ€í•œ film í…Œì´ë¸”ì˜ ëª¨ë“  ì»¬ëŸ¼ì„ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ16ë²ˆ)	langugage í…Œì´ë¸”ì— ìˆëŠ” id, name ì»¬ëŸ¼ì„ í™•ì¸í•´ë³´ì„¸ìš” .
    
    ë¬¸ì œ17ë²ˆ)	film í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬,  rental_duration ì´  7ì¼ ì´ìƒ ëŒ€ì—¬ê°€ ê°€ëŠ¥í•œ  film ì— ëŒ€í•´ì„œ  film_id,   title,  description ì»¬ëŸ¼ì„ í™•ì¸í•´ë³´ì„¸ìš”.
    
    ë¬¸ì œ18ë²ˆ)	film í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬,  rental_duration   ëŒ€ì—¬ê°€ ê°€ëŠ¥í•œ ì¼ìê°€ 3ì¼ ë˜ëŠ” 5ì¼ì— í•´ë‹¹í•˜ëŠ”  film_id,  title, desciption ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ19ë²ˆ)	Actor í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬,  ì´ë¦„ì´ Nick ì´ê±°ë‚˜  ì„±ì´ Hunt ì¸  ë°°ìš°ì˜  id ì™€  ì´ë¦„, ì„±ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ20ë²ˆ)	Actor í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, Actor í…Œì´ë¸”ì˜  first_name ì»¬ëŸ¼ê³¼ last_name ì»¬ëŸ¼ì„ , firstname, lastname ìœ¼ë¡œ ì»¬ëŸ¼ëª…ì„ ë°”ê¿”ì„œ ë³´ì—¬ì£¼ì„¸ìš”
    
- 1 ì •ë‹µ
    
    í€´ì¦ˆ 1 ì •ë‹µ
    
    ë¬¸ì œ1ë²ˆ) dvd ë Œíƒˆ ì—…ì²´ì˜Â  dvd ëŒ€ì—¬ê°€ ìˆì—ˆë˜ ë‚ ì§œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select distinct date(rental_date)
    from rental
    ```
    
    ë¬¸ì œ2ë²ˆ) ì˜í™”ê¸¸ì´ê°€ 120ë¶„ ì´ìƒì´ë©´ì„œ, ëŒ€ì—¬ê¸°ê°„ì´ 4ì¼ ì´ìƒì´ ê°€ëŠ¥í•œ, ì˜í™”ì œëª©ì„ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select title
    from film
    where length >=120
    and rental_duration>=4
    ```
    
    ë¬¸ì œ3ë²ˆ) ì§ì›ì˜ id ê°€ 2 ë²ˆì¸Â  ì§ì›ì˜Â  id, ì´ë¦„, ì„±ì„ ì•Œë ¤ì£¼ì„¸ìš”
    
    ```sql
    select staff_id , first_name , last_name
    from staff
    where staff_id =2
    ```
    
    ë¬¸ì œ4ë²ˆ) ì§€ë¶ˆ ë‚´ì—­ ì¤‘ì—ì„œ,Â Â  ì§€ë¶ˆ ë‚´ì—­ ë²ˆí˜¸ê°€ 17510 ì— í•´ë‹¹í•˜ëŠ”Â  ,Â  ê³ ê°ì˜ ì§€ì¶œ ë‚´ì—­ (amount ) ëŠ” ì–¼ë§ˆì¸ê°€ìš”?
    
    ```sql
    select amount
    from payment
    where payment_id = 17510
    ```
    
    ë¬¸ì œ5ë²ˆ) ì˜í™” ì¹´í…Œê³ ë¦¬ ì¤‘ì—ì„œ ,Sci-FiÂ  ì¹´í…Œê³ ë¦¬ì˜Â  ì¹´í…Œê³ ë¦¬ ë²ˆí˜¸ëŠ” ëª‡ë²ˆì¸ê°€ìš”?
    
    ```sql
    select category_id
    from category
    where name ='Sci-Fi'
    ```
    
    ë¬¸ì œ6ë²ˆ) film í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬, ratingÂ  ë“±ê¸‰(?) ì— ëŒ€í•´ì„œ, ëª‡ê°œì˜ ë“±ê¸‰ì´ ìˆëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”.
    
    ```sql
    select distinct rating
    from film
    ```
    
    ë¬¸ì œ7ë²ˆ) ëŒ€ì—¬ ê¸°ê°„ì´ (íšŒìˆ˜ - ëŒ€ì—¬ì¼) 10ì¼ ì´ìƒì´ì˜€ë˜ rental í…Œì´ë¸”ì— ëŒ€í•œ ëª¨ë“  ì •ë³´ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë‹¨ , ëŒ€ì—¬ê¸°ê°„ì€Â  ëŒ€ì—¬ì¼ìë¶€í„° ëŒ€ì—¬ê¸°ê°„ìœ¼ë¡œ í¬í•¨í•˜ì—¬ ê³„ì‚°í•©ë‹ˆë‹¤.
    
    ```sql
    select *,Â  date(return_date) - date(rental_date) +1 
    					as diff_date
    where date(return_date) - date(rental_date) +1 >=10
    ```
    
    ë¬¸ì œ8ë²ˆ) ê³ ê°ì˜ id ê°€Â  50,100,150 ..ë“± 50ë²ˆì˜ ë°°ìˆ˜ì— í•´ë‹¹í•˜ëŠ” ê³ ê°ë“¤ì— ëŒ€í•´ì„œ, íšŒì› ê°€ì… ê°ì‚¬ ì´ë²¤íŠ¸ë¥¼ ì§„í–‰í•˜ë ¤ê³ í•©ë‹ˆë‹¤. ê³ ê° ì•„ì´ë””ê°€ 50ë²ˆ ë°°ìˆ˜ì¸ ì•„ì´ë””ì™€, ê³ ê°ì˜ ì´ë¦„ (ì„±, ì´ë¦„)ê³¼ ì´ë©”ì¼ì— ëŒ€í•´ì„œ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select customer_id, last_name, first_name, email
    from customer
    where mod(customer_id,50) =0
    ```
    
    ë¬¸ì œ9ë²ˆ) ì˜í™” ì œëª©ì˜ ê¸¸ì´ê°€ 8ê¸€ìì¸, ì˜í™” ì œëª© ë¦¬ìŠ¤íŠ¸ë¥¼ ë‚˜ì—´í•´ì£¼ì„¸ìš”.
    
    ```sql
    selectÂ  length(title), title
    from film
    where length(title) =8
    order by title
    ```
    
    ë¬¸ì œ10ë²ˆ) city í…Œì´ë¸”ì˜ city ê°¯ìˆ˜ëŠ” ëª‡ê°œì¸ê°€ìš”?
    
    ```sql
    select count(*)
    from city
    ```
    
    ë¬¸ì œ11ë²ˆ) ì˜í™”ë°°ìš°ì˜ ì´ë¦„ (ì´ë¦„+' '+ì„±) ì— ëŒ€í•´ì„œ,Â  ëŒ€ë¬¸ìë¡œ ì´ë¦„ì„ ë³´ì—¬ì£¼ì„¸ìš”.Â  ë‹¨ ê³ ê°ì˜ ì´ë¦„ì´ ë™ì¼í•œ ì‚¬ëŒì´ ìˆë‹¤ë©´,Â  ì¤‘ë³µ ì œê±°í•˜ê³ , ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select distinct upper(first_name ||' '|| last_name)
    from actor
    ```
    
    ë¬¸ì œ12ë²ˆ) ê³ ê° ì¤‘ì—ì„œ,Â  active ìƒíƒœê°€ 0 ì¸ ì¦‰ í˜„ì¬ ì‚¬ìš©í•˜ì§€ ì•Šê³  ìˆëŠ” ê³ ê°ì˜ ìˆ˜ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select count(distinct customer_id)
    from customer c
    where active =0
    ```
    
    ë¬¸ì œ13ë²ˆ) Customer í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬,Â  store_id = 1 ì— ë§¤í•‘ëœÂ  ê³ ê°ì˜ ìˆ˜ëŠ” ëª‡ëª…ì¸ì§€ í™•ì¸í•´ë³´ì„¸ìš”.
    
    ```sql
    select count(distinct customer_id)
    from customer c
    where store_id =1
    ```
    
    ë¬¸ì œ14ë²ˆ) rental í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬,Â  ê³ ê°ì´ return í–ˆë˜ ë‚ ì§œê°€ 2005ë…„6ì›”20ì¼ì— í•´ë‹¹í–ˆë˜ rental ì˜ ê°¯ìˆ˜ê°€ ëª‡ê°œì˜€ëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”.
    
    ```sql
    select count(distinct rental_id)
    from rental r
    where date(return_date) ='2005-06-20'
    ```
    
    ë¬¸ì œ15ë²ˆ) film í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬, 2006ë…„ì— ì¶œì‹œê°€ ë˜ê³  rating ì´ 'G' ë“±ê¸‰ì— í•´ë‹¹í•˜ë©°, ëŒ€ì—¬ê¸°ê°„ì´ 3ì¼ì— í•´ë‹¹í•˜ëŠ”Â  ê²ƒì— ëŒ€í•œ film í…Œì´ë¸”ì˜ ëª¨ë“  ì»¬ëŸ¼ì„ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select *
    from film
    where release_yearÂ  ='2006'
    and rental_duration =3
    and rating ='G'
    ```
    
    ë¬¸ì œ16ë²ˆ) langugage í…Œì´ë¸”ì— ìˆëŠ” id, name ì»¬ëŸ¼ì„ í™•ì¸í•´ë³´ì„¸ìš” .
    
    ```sql
    select language_id , name
    from language
    ```
    
    ë¬¸ì œ17ë²ˆ) film í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬,Â  rental_duration ì´Â  7ì¼ ì´ìƒ ëŒ€ì—¬ê°€ ê°€ëŠ¥í•œÂ  film ì— ëŒ€í•´ì„œÂ  film_id,Â Â  title,Â  description ì»¬ëŸ¼ì„ í™•ì¸í•´ë³´ì„¸ìš”.
    
    ```sql
    select film_id ,title, description
    from film
    where rental_duration >=7
    ```
    
    ë¬¸ì œ18ë²ˆ) film í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬,Â  rental_durationÂ Â  ëŒ€ì—¬ê°€ ê°€ëŠ¥í•œ ì¼ìê°€ 3ì¼ ë˜ëŠ” 5ì¼ì— í•´ë‹¹í•˜ëŠ”Â  film_id,Â  title, desciption ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select film_id ,title, description
    from film
    where rental_duration =3 orÂ  rental_duration =5
    ```
    
    ë¬¸ì œ19ë²ˆ) Actor í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬,Â  ì´ë¦„ì´ Nick ì´ê±°ë‚˜Â  ì„±ì´ Hunt ì¸Â  ë°°ìš°ì˜Â  id ì™€Â  ì´ë¦„, ì„±ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select actor_id , first_name , last_name
    from actor
    where first_nameÂ  ='Nick' or last_name ='Hunt'
    ```
    
    ë¬¸ì œ20ë²ˆ) Actor í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, Actor í…Œì´ë¸”ì˜Â  first_name ì»¬ëŸ¼ê³¼ last_name ì»¬ëŸ¼ì„ , firstname, lastname ìœ¼ë¡œ ì»¬ëŸ¼ëª…ì„ ë°”ê¿”ì„œ ë³´ì—¬ì£¼ì„¸ìš”
    
    ```sql
    select first_nameÂ  as firstname, 
    				last_name as lastname
    ```
    
- 2
    
    ë¬¸ì œ1ë²ˆ) film í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬,  film í…Œì´ë¸”ì˜  100ê°œì˜ row ë§Œ í™•ì¸í•´ë³´ì„¸ìš”.
    
    ë¬¸ì œ2ë²ˆ) actor ì˜ ì„±(last_name) ì´  Jo ë¡œ ì‹œì‘í•˜ëŠ” ì‚¬ëŒì˜ id ê°’ì´ ê°€ì¥ ë‚®ì€ ì‚¬ëŒ í•œì‚¬ëŒì— ëŒ€í•˜ì—¬, ì‚¬ëŒì˜  id ê°’ê³¼  ì´ë¦„, ì„± ì„ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ3ë²ˆ)film í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, film í…Œì´ë¸”ì˜ ì•„ì´ë””ê°’ì´ 1~10 ì‚¬ì´ì— ìˆëŠ” ëª¨ë“  ì»¬ëŸ¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ4ë²ˆ) country í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, country ì´ë¦„ì´ A ë¡œ ì‹œì‘í•˜ëŠ” country ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ5ë²ˆ) country í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, country ì´ë¦„ì´ s ë¡œ ëë‚˜ëŠ” country ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ6ë²ˆ) address í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, ìš°í¸ë²ˆí˜¸(postal_code) ê°’ì´ 77ë¡œ ì‹œì‘í•˜ëŠ”  ì£¼ì†Œì— ëŒ€í•˜ì—¬, address_id, address, district ,postal_code  ì»¬ëŸ¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ7ë²ˆ) address í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, ìš°í¸ë²ˆí˜¸(postal_code) ê°’ì´  ë‘ë²ˆì§¸ê¸€ìê°€ 1ì¸ ìš°í¸ë²ˆí˜¸ì˜  address_id, address, district ,postal_code  ì»¬ëŸ¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ8ë²ˆ) payment í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬,  ê³ ê°ë²ˆí˜¸ê°€ 341ì— í•´ë‹¹ í•˜ëŠ” ì‚¬ëŒì´ ê²°ì œë¥¼ 2007ë…„ 2ì›” 15~16ì¼ ì‚¬ì´ì— í•œ ëª¨ë“  ê²°ì œë‚´ì—­ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ9ë²ˆ) payment í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, ê³ ê°ë²ˆí˜¸ê°€ 355ì— í•´ë‹¹ í•˜ëŠ” ì‚¬ëŒì˜ ê²°ì œ ê¸ˆì•¡ì´ 1~3ì› ì‚¬ì´ì— í•´ë‹¹í•˜ëŠ” ëª¨ë“  ê²°ì œ ë‚´ì—­ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ10ë²ˆ) customer í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, ê³ ê°ì˜ ì´ë¦„ì´ Maria, Lisa, Mike ì— í•´ë‹¹í•˜ëŠ” ì‚¬ëŒì˜ id, ì´ë¦„, ì„±ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ11ë²ˆ) film í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬,  filmì˜ ê¸¸ì´ê°€  100~120 ì— í•´ë‹¹í•˜ê±°ë‚˜ ë˜ëŠ” rental ëŒ€ì—¬ê¸°ê°„ì´ 3~5ì¼ì— í•´ë‹¹í•˜ëŠ” film ì˜ ëª¨ë“  ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ12ë²ˆ) address í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, postal_code ê°’ì´  ê³µë°±('') ì´ê±°ë‚˜ 35200, 17886 ì— í•´ë‹¹í•˜ëŠ” address ì— ëª¨ë“  ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ13ë²ˆ) address í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬,  address ì˜ ìƒì„¸ì£¼ì†Œ(=address2) ê°’ì´  ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ëª¨ë“  ë°ì´í„°ë¥¼ í™•ì¸í•˜ì—¬ ì£¼ì„¸ìš”.
    
    ë¬¸ì œ14ë²ˆ) staff í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, staff ì˜  picture  ì‚¬ì§„ì˜ ê°’ì´ ìˆëŠ”  ì§ì›ì˜  id, ì´ë¦„,ì„±ì„ í™•ì¸í•´ì£¼ì„¸ìš”.  ë‹¨ ì´ë¦„ê³¼ ì„±ì„  í•˜ë‚˜ì˜ ì»¬ëŸ¼ìœ¼ë¡œ ì´ë¦„, ì„±ì˜í˜•íƒœë¡œ  ìƒˆë¡œìš´ ì»¬ëŸ¼ name ì»¬ëŸ¼ìœ¼ë¡œ ë„ì¶œí•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ15ë²ˆ) rental í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬,  ëŒ€ì—¬ëŠ”í–ˆìœ¼ë‚˜ ì•„ì§ ë°˜ë‚© ê¸°ë¡ì´ ì—†ëŠ” ëŒ€ì—¬ê±´ì˜ ëª¨ë“  ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ16ë²ˆ) address í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, postal_code ê°’ì´  ë¹ˆ ê°’(NULL) ì´ê±°ë‚˜ 35200, 17886 ì— í•´ë‹¹í•˜ëŠ” address ì— ëª¨ë“  ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ17ë²ˆ) ê³ ê°ì˜ ì„±ì— John ì´ë¼ëŠ” ë‹¨ì–´ê°€ ë“¤ì–´ê°€ëŠ”, ê³ ê°ì˜ ì´ë¦„ê³¼ ì„±ì„ ëª¨ë‘ ì°¾ì•„ì£¼ì„¸ìš”.
    
    ë¬¸ì œ18ë²ˆ) ì£¼ì†Œ í…Œì´ë¸”ì—ì„œ, address2 ê°’ì´ null ê°’ì¸ row ì „ì²´ë¥¼ í™•ì¸í•´ë³¼ê¹Œìš”?
    
- 2 ì •ë‹µ
    
    ë¬¸ì œ1ë²ˆ) film í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬,Â  film í…Œì´ë¸”ì˜Â  100ê°œì˜ row ë§Œ í™•ì¸í•´ë³´ì„¸ìš”.
    
    ```sql
    select *
    
    from film
    
    limit 100
    ```
    
    ë¬¸ì œ2ë²ˆ) actor ì˜ ì„±(last_name) ì´Â  Jo ë¡œ ì‹œì‘í•˜ëŠ” ì‚¬ëŒì˜ id ê°’ì´ ê°€ì¥ ë‚®ì€ ì‚¬ëŒ í•œì‚¬ëŒì— ëŒ€í•˜ì—¬, ì‚¬ëŒì˜Â  id ê°’ê³¼Â  ì´ë¦„, ì„± ì„ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select actor_id, first_name , last_name
    
    from actor
    
    where last_name like 'Jo%'
    
    order by actor_id
    
    limit 1
    ```
    
    ë¬¸ì œ3ë²ˆ)film í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, film í…Œì´ë¸”ì˜ ì•„ì´ë””ê°’ì´ 1~10 ì‚¬ì´ì— ìˆëŠ” ëª¨ë“  ì»¬ëŸ¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select *
    
    from film
    
    where film_id between 1 and 10
    ```
    
    ë¬¸ì œ4ë²ˆ) country í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, country ì´ë¦„ì´ A ë¡œ ì‹œì‘í•˜ëŠ” country ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select *
    
    from country where country like 'A%'
    ```
    
    ë¬¸ì œ5ë²ˆ) country í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, country ì´ë¦„ì´ s ë¡œ ëë‚˜ëŠ” country ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select *
    from country
    where lower(country) like '%s'
    ```
    
    ë¬¸ì œ6ë²ˆ) address í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, ìš°í¸ë²ˆí˜¸(postal_code) ê°’ì´ 77ë¡œ ì‹œì‘í•˜ëŠ”Â  ì£¼ì†Œì— ëŒ€í•˜ì—¬,Â Â Â  address_id, address, district ,postal_codeÂ  ì»¬ëŸ¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select address_id, address, district ,postal_code
    from address
    where postal_code like '77%'
    ```
    
    ë¬¸ì œ7ë²ˆ) address í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, ìš°í¸ë²ˆí˜¸(postal_code) ê°’ì´Â  ë‘ë²ˆì§¸ê¸€ìê°€ 1ì¸ ìš°í¸ë²ˆí˜¸ì˜Â Â Â Â Â  address_id, address, district ,postal_codeÂ  ì»¬ëŸ¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select address_id, address, district ,postal_code
    
    from address
    
    where substring(postal_code,2,1) ='1'
    ```
    
    ë¬¸ì œ8ë²ˆ) payment í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬,Â  ê³ ê°ë²ˆí˜¸ê°€ 341ì— í•´ë‹¹ í•˜ëŠ” ì‚¬ëŒì´ ê²°ì œë¥¼ 2007ë…„ 2ì›” 15~16ì¼ ì‚¬ì´ì— í•œ ëª¨ë“  ê²°ì œë‚´ì—­ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select *
    
    from payment
    
    where customer_id =341
    
    and payment_date between '2007-02-15 00:00:00' and '2007-02-16 23:59:59'
    ```
    
    ë¬¸ì œ9ë²ˆ) payment í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, ê³ ê°ë²ˆí˜¸ê°€ 355ì— í•´ë‹¹ í•˜ëŠ” ì‚¬ëŒì˜ ê²°ì œ ê¸ˆì•¡ì´ 1~3ì› ì‚¬ì´ì— í•´ë‹¹í•˜ëŠ” ëª¨ë“  ê²°ì œ ë‚´ì—­ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select *
    
    from payment
    
    where customer_id =355
    
    and amount between 1 and 3
    ```
    
    ë¬¸ì œ10ë²ˆ) customer í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, ê³ ê°ì˜ ì´ë¦„ì´ Maria, Lisa, Mike ì— í•´ë‹¹í•˜ëŠ” ì‚¬ëŒì˜ id, ì´ë¦„, ì„±ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select customer_id ,first_name ,last_name
    
    from customer
    
    where first_nameÂ  in ('Maria','Lisa','Mike')
    ```
    
    ë¬¸ì œ11ë²ˆ) film í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬,Â  filmì˜ ê¸¸ì´ê°€Â  100~120 ì— í•´ë‹¹í•˜ê±°ë‚˜ ë˜ëŠ” rental ëŒ€ì—¬ê¸°ê°„ì´ 3~5ì¼ì— í•´ë‹¹í•˜ëŠ” film ì˜ ëª¨ë“  ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select*
    
    from film f
    
    where ( length between 100 and 120 )
    
    or (rental_duration between 3 and 5)
    ```
    
    ë¬¸ì œ12ë²ˆ) address í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, postal_code ê°’ì´Â  ê³µë°±('') ì´ê±°ë‚˜ 35200, 17886 ì— í•´ë‹¹í•˜ëŠ” address ì— ëª¨ë“  ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select *, 
    	case when postcal_code ='' 
    	then 'empty' else cast(postal_code as varchar)Â  end as postal_code_emptyflag
    
    from address
    where postal_codeÂ  in ('', '35200','17886')
    ```
    
    ë¬¸ì œ13ë²ˆ) address í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬,Â  address ì˜ ìƒì„¸ì£¼ì†Œ(=address2) ê°’ì´Â  ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ëª¨ë“  ë°ì´í„°ë¥¼ í™•ì¸í•˜ì—¬ ì£¼ì„¸ìš”.
    
    ```sql
    select *,Â  
    coalesce(address2,'empty') as new_address2
    from address
    where address2 is null
    ```
    
    ë¬¸ì œ14ë²ˆ) staff í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, staff ì˜Â  pictureÂ  ì‚¬ì§„ì˜ ê°’ì´ ìˆëŠ”Â  ì§ì›ì˜Â  id, ì´ë¦„,ì„±ì„ í™•ì¸í•´ì£¼ì„¸ìš”.Â  ë‹¨ ì´ë¦„ê³¼ ì„±ì„Â  í•˜ë‚˜ì˜ ì»¬ëŸ¼ìœ¼ë¡œ ì´ë¦„, ì„±ì˜í˜•íƒœë¡œÂ  ìƒˆë¡œìš´ ì»¬ëŸ¼ name ì»¬ëŸ¼ìœ¼ë¡œ ë„ì¶œí•´ì£¼ì„¸ìš”.
    
    ```sql
    select staff_id, first_name ||', '|| last_nameÂ  as name
    from staffs
    where pictureÂ  is not null
    ```
    
    ë¬¸ì œ15ë²ˆ) rental í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬,Â  ëŒ€ì—¬ëŠ”í–ˆìœ¼ë‚˜ ì•„ì§ ë°˜ë‚© ê¸°ë¡ì´ ì—†ëŠ” ëŒ€ì—¬ê±´ì˜ ëª¨ë“  ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.\
    
    ```sql
    select *
    
    from rental
    
    where return_dateÂ  is null
    ```
    
    ë¬¸ì œ16ë²ˆ) address í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, postal_code ê°’ì´Â  ë¹ˆ ê°’(NULL) ì´ê±°ë‚˜ 35200, 17886 ì— í•´ë‹¹í•˜ëŠ” address ì— ëª¨ë“  ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select *
    from address
    where postal_codeÂ  in ('35200','17886') or postal_code is null
    ```
    
    ë¬¸ì œ17ë²ˆ) ê³ ê°ì˜ ì„±ì— John ì´ë¼ëŠ” ë‹¨ì–´ê°€ ë“¤ì–´ê°€ëŠ”, ã„´ã„·ê°ì˜ ì´ë¦„ê³¼ ì„±ì„ ëª¨ë‘ ì°¾ì•„ì£¼ì„¸ìš”.
    
    ```sql
    select first_name, last_name
    from customer
    where last_name like '%John%'
    ```
    
    ë¬¸ì œ18ë²ˆ) ì£¼ì†Œ í…Œì´ë¸”ì—ì„œ, address2 ê°’ì´ null ê°’ì¸ row ì „ì²´ë¥¼ í™•ì¸í•´ë³¼ê¹Œìš”?
    
    ```sql
    select *
    from address
    where address2 is null
    ```
    

---

### **1ì£¼ì°¨ í€´ì¦ˆ**

- `ë˜ ë‹¤ë¥¸ ë””ë¹„ë¥¼ ì‚¬ìš©í•œ í€´ì¦ˆ ì ‘ì†ë°©ë²• ë° ERD - **í€´ì¦ˆ\[ ìš©**`
    
    Host 206.189.155.123
    
    Port 5433
    Database postgres
    Username camp
    Password camp
    
    ![S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2021.png](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2021.png)
    
    ![S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2021.png](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2021.png)
    
- 1ì£¼ì°¨ í€´ì¦ˆ
    
    **í€´ì¦ˆ**
    
    ë¬¸ì œ1ë²ˆ)  ê° ì œí’ˆ ê°€ê²©ì„ 5 % ì¤„ì´ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”?
    
    ```sql
    
    ```
    
    ë¬¸ì œ2ë²ˆ)  ê³ ê°ì´ ì£¼ë¬¸í•œ ëª©ë¡ì„ ì£¼ë¬¸ ì¼ìë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬í•´ì„œ ë³´ì—¬ì£¼ì„¸ìš”.
    
    ```sql
    
    ```
    
    ë¬¸ì œ3ë²ˆ)  employees í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, 705 ì•„ì´ë””ë¥¼ ê°€ì§„ ì§ì›ì˜ , ì´ë¦„, ì„±ê³¼  í•´ë‹¹ ì§ì›ì˜  íƒœì–´ë‚œ í•´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    
    ```
    
    ë¬¸ì œ4ë²ˆ)  customers í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬,  ê³ ê°ì˜ ì´ë¦„ê³¼ ì„±ì„ í•˜ë‚˜ì˜ ì»¬ëŸ¼ìœ¼ë¡œ ì „ì²´ ì´ë¦„ì„ ë³´ì—¬ì£¼ì„¸ìš” (ì´ë¦„, ì„± ì˜ í˜•íƒœë¡œ  full_name ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ë³´ì—¬ì£¼ì„¸ìš”)
    
    ```sql
    
    ```
    
    ë¬¸ì œ5ë²ˆ) orders í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬, ê³ ê°ë²ˆí˜¸ê°€ 1001 ì— í•´ë‹¹í•˜ëŠ” ì‚¬ëŒì´ employeeid ê°€ 707ì¸ ì§ì›ìœ¼ë¡œë¶€í„°  ì‚° ì£¼ë¬¸ì˜ id ì™€ ì£¼ë¬¸ ë‚ ì§œë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    * ì£¼ë¬¸ì¼ì ë¹ ë¥¸ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì—¬, ë³´ì—¬ì£¼ì„¸ìš”.
    
    ```sql
    
    ```
    
    ë¬¸ì œ6ë²ˆ)  vendors í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, ë²¤ë”ê°€ ìœ„ì¹˜í•œ state ì£¼ê°€ ì–´ë–»ê²Œ ë˜ëŠ”ì§€, í™•ì¸í•´ë³´ì„¸ìš”.  ì¤‘ë³µëœ ì£¼ê°€ ìˆë‹¤ë©´, ì¤‘ë³µì œê±° í›„ì— ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    
    ```
    
    ë¬¸ì œ7ë²ˆ) ì£¼ë¬¸ì¼ìê°€  2017-09-02~ 09-03ì¼ ì‚¬ì´ì— í•´ë‹¹í•˜ëŠ” ì£¼ë¬¸ ë²ˆí˜¸ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    
    ```
    
    ë¬¸ì œ8ë²ˆ) products í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬, productdescriptionì— ìƒí’ˆ ìƒì„¸ ì„¤ëª… ê°’ì´ ì—†ëŠ”  ìƒí’ˆ ë°ì´í„°ë¥¼ ëª¨ë‘ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    
    ```
    
    ë¬¸ì œ9 ë²ˆ) vendors í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, vendorì˜ State ì§€ì—­ì´ NY ë˜ëŠ” WA ì¸ ì—…ì²´ì˜ ì´ë¦„ì„ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    
    ```
    
    ë¬¸ì œ10ë²ˆ)  customers í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, ê³ ê°ì˜ id ë³„ë¡œ,  custstate ì§€ì—­ ì¤‘ WA ì§€ì—­ì— ì‚¬ëŠ” ì‚¬ëŒê³¼  WA ê°€ ì•„ë‹Œ ì§€ì—­ì— ì‚¬ëŠ” ì‚¬ëŒì„ êµ¬ë¶„í•´ì„œ  ë³´ì—¬ì£¼ì„¸ìš”.
    
    - customerid ì™€, newstate_flag ì»¬ëŸ¼ìœ¼ë¡œ êµ¬ì„±í•´ì£¼ì„¸ìš” .
    - newstate_flag ì»¬ëŸ¼ì€ WA ì™€ OTHERS ë¡œ ë…¸ì¶œí•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.
    
    ```sql
    
    ```
    
- 1ì£¼ì°¨ í€´ì¦ˆ ì •ë‹µ
    
    ë¬¸ì œ1ë²ˆ)  ê° ì œí’ˆ ê°€ê²©ì„ 5 % ì¤„ì´ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”?
    
    ```sql
     select productname, retailprice, retailprice *0.95
       from products
    ```
    
    ë¬¸ì œ2ë²ˆ)  ê³ ê°ì´ ì£¼ë¬¸í•œ ëª©ë¡ì„ ì£¼ë¬¸ ì¼ìë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬í•´ì„œ ë³´ì—¬ì£¼ì„¸ìš”.
    
    ```sql
     select  ordernumber, orderdate, customerid
       from orders
      order by orderdate desc
    ```
    
    ë¬¸ì œ3ë²ˆ)  employees í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, 705 ì•„ì´ë””ë¥¼ ê°–ì€  ì§ì›ì˜ , ì´ë¦„, ì„±ê³¼  í•´ë‹¹ ì§ì›ì˜  íƒœì–´ë‚œ í•´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select empfirstname, emplastname,extract
    	( year from empbirthdate) 
    	as birsthday_yyyy
    from employees
    where employeeid = 705
    ```
    
    ë¬¸ì œ4ë²ˆ)  customers í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬,  ê³ ê°ì˜ ì´ë¦„ê³¼ ì„±ì„ í•˜ë‚˜ì˜ ì»¬ëŸ¼ìœ¼ë¡œ ì „ì²´ ì´ë¦„ì„ ë³´ì—¬ì£¼ì„¸ìš” (ì´ë¦„, ì„± ì˜ í˜•íƒœë¡œ  full_name ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ë³´ì—¬ì£¼ì„¸ìš”)
    
    ```sql
        select first_name ||', '|| last_name  as  full_name, *
        from customer
    
    ```
    
    ë¬¸ì œ5ë²ˆ) orders í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬, ê³ ê°ë²ˆí˜¸ê°€ 1001 ì— í•´ë‹¹í•˜ëŠ” ì‚¬ëŒì´ employeeid ê°€ 707ì¸ ì§ì›ìœ¼ë¡œë¶€í„°  ì‚° ì£¼ë¬¸ì˜ id ì™€ ì£¼ë¬¸ ë‚ ì§œë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    * ì£¼ë¬¸ì¼ì ë¹ ë¥¸ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì—¬, ë³´ì—¬ì£¼ì„¸ìš”.
    
    ```sql
    select ordernumber, orderdate
    from orders
    where customerid =1001
    and employeeid=707
    order by ordernumber  asc
    ```
    
    ë¬¸ì œ6ë²ˆ)  vendors í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, ë²¤ë”ê°€ ìœ„ì¹˜í•œ state ì£¼ê°€ ì–´ë–»ê²Œ ë˜ëŠ”ì§€, í™•ì¸í•´ë³´ì„¸ìš”.  ì¤‘ë³µëœ ì£¼ê°€ ìˆë‹¤ë©´, ì¤‘ë³µì œê±° í›„ì— ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select distinct vendstate
    from vendors v
    ```
    
    ë¬¸ì œ7ë²ˆ) ì£¼ë¬¸ì¼ìê°€  2017-09-02~ 09-03ì¼ ì‚¬ì´ì— í•´ë‹¹í•˜ëŠ” ì£¼ë¬¸ ë²ˆí˜¸ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select ordernumber
    from orders
    where orderdate  between '2017-09-02' and '2017-09-03'
    ```
    
    ë¬¸ì œ8ë²ˆ) products í…Œì´ë¸”ì„ í™œìš©í•˜ì—¬, productdescriptionì— ìƒí’ˆ ìƒì„¸ ì„¤ëª… ê°’ì´ ì—†ëŠ”  ìƒí’ˆ ë°ì´í„°ë¥¼ ëª¨ë‘ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select *,  coalesce(productdescription ,'Empty') as new_productdescription
    from products
    where productdescription is null
    ;
    ```
    
    ë¬¸ì œ9 ë²ˆ) vendors í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, vendorì˜ State ì§€ì—­ì´ NY ë˜ëŠ” WA ì¸ ì—…ì²´ì˜ ì´ë¦„ì„ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select vendname
    from vendors
    where vendstate  in ('NY','WA')
    ```
    
    ë¬¸ì œ10ë²ˆ)  customers í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬, ê³ ê°ì˜ id ë³„ë¡œ,  custstate ì§€ì—­ ì¤‘ WA ì§€ì—­ì— ì‚¬ëŠ” ì‚¬ëŒê³¼  WA ê°€ ì•„ë‹Œ ì§€ì—­ì— ì‚¬ëŠ” ì‚¬ëŒì„ êµ¬ë¶„í•´ì„œ  ë³´ì—¬ì£¼ì„¸ìš”.
    
    - customerid ì™€, newstate_flag ì»¬ëŸ¼ìœ¼ë¡œ êµ¬ì„±í•´ì£¼ì„¸ìš” .
    - newstate_flag ì»¬ëŸ¼ì€ WA ì™€ OTHERS ë¡œ ë…¸ì¶œí•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.
    
    ```sql
    select customerid ,
    case when custstate ='WA' then 'WA' else 'OTHERS' end as newstate_flag
    from customers c
    
    -- CASE ë¬¸ì€ ì–´ë–»ê²Œ ì“°ëŠ”ê±´ì§€ ì•Œì•„ë³´ì„¸ìš”! :)
    ```
    

### **2ì£¼ì°¨ ì‹¤ìŠµë¬¸ì œ**

---

- 3
    
    ë¬¸ì œ1ë²ˆ) ê³ ê°ì˜ ê¸°ë³¸ ì •ë³´ì¸, ê³ ê° id, ì´ë¦„, ì„±, ì´ë©”ì¼ê³¼ í•¨ê»˜ ê³ ê°ì˜ ì£¼ì†Œ address, district, postal_code, phone ë²ˆí˜¸ë¥¼ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    
    ë¬¸ì œ2ë²ˆ) ê³ ê°ì˜  ê¸°ë³¸ ì •ë³´ì¸, ê³ ê° id, ì´ë¦„, ì„±, ì´ë©”ì¼ê³¼ í•¨ê»˜ ê³ ê°ì˜ ì£¼ì†Œ address, district, postal_code, phone , city ë¥¼ í•¨ê»˜ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ3ë²ˆ) Lima Cityì— ì‚¬ëŠ” ê³ ê°ì˜ ì´ë¦„ê³¼, ì„±, ì´ë©”ì¼, phonenumberì— ëŒ€í•´ì„œ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ4ë²ˆ) rental ì •ë³´ì— ì¶”ê°€ë¡œ, ê³ ê°ì˜ ì´ë¦„ê³¼, ì§ì›ì˜ ì´ë¦„ì„ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    
    - ê³ ê°ì˜ ì´ë¦„, ì§ì› ì´ë¦„ì€ ì´ë¦„ê³¼ ì„±ì„ fullname ì»¬ëŸ¼ìœ¼ë¡œë§Œë“¤ì–´ì„œ ì§ì›ì´ë¦„/ê³ ê°ì´ë¦„ 2ê°œì˜ ì»¬ëŸ¼ìœ¼ë¡œ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ5ë²ˆ) [seth.hannon@sakilacustomer.org](mailto:seth.hannon@sakilacustomer.org) ì´ë©”ì¼ ì£¼ì†Œë¥¼ ê°€ì§„ ê³ ê°ì˜  ì£¼ì†Œ address, address2, postal_code, phone, city ì£¼ì†Œë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ6ë²ˆ) Jon Stephens ì§ì›ì„ í†µí•´ dvdëŒ€ì—¬ë¥¼ í•œ payment ê¸°ë¡ ì •ë³´ë¥¼  í™•ì¸í•˜ë ¤ê³  í•©ë‹ˆë‹¤.
    - payment_id,  ê³ ê° ì´ë¦„ ê³¼ ì„±,  rental_id, amount, staff ì´ë¦„ê³¼ ì„±ì„ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ7ë²ˆ) ë°°ìš°ê°€ ì¶œì—°í•˜ì§€ ì•ŠëŠ” ì˜í™”ì˜ film_id, title, release_year, rental_rate, length ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ8ë²ˆ) store ìƒì  idë³„ ì£¼ì†Œ (address, address2, distict) ì™€ í•´ë‹¹ ìƒì ì´ ìœ„ì¹˜í•œ city ì£¼ì†Œë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ9ë²ˆ) ê³ ê°ì˜ id ë³„ë¡œ ê³ ê°ì˜ ì´ë¦„ (first_name, last_name), ì´ë©”ì¼, ê³ ê°ì˜ ì£¼ì†Œ (address, district), phoneë²ˆí˜¸, city, country ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ10ë²ˆ) country ê°€ china ê°€ ì•„ë‹Œ ì§€ì—­ì— ì‚¬ëŠ”, ê³ ê°ì˜ ì´ë¦„(first_name, last_name)ê³¼ , email, phonenumber, country, city ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”
    
    ë¬¸ì œ11ë²ˆ) Horror ì¹´í…Œê³ ë¦¬ ì¥ë¥´ì— í•´ë‹¹í•˜ëŠ” ì˜í™”ì˜ ì´ë¦„ê³¼ description ì— ëŒ€í•´ì„œ ì•Œë ¤ì£¼ì„¸ìš”
    
    ë¬¸ì œ12ë²ˆ) Music ì¥ë¥´ì´ë©´ì„œ, ì˜í™”ê¸¸ì´ê°€ 60~180ë¶„ ì‚¬ì´ì— í•´ë‹¹í•˜ëŠ” ì˜í™”ì˜ title, description, length ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    - ì˜í™” ê¸¸ì´ê°€ ì§§ì€ ìˆœìœ¼ë¡œ ì •ë ¬í•´ì„œ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ13ë²ˆ) actor í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬,  ë°°ìš°ì˜ ID, ì´ë¦„, ì„± ì»¬ëŸ¼ì— ì¶”ê°€ë¡œ    'Angels Life' ì˜í™”ì— ë‚˜ì˜¨ ì˜í™” ë°°ìš° ì—¬ë¶€ë¥¼ Y , N ìœ¼ë¡œ ì»¬ëŸ¼ì„ ì¶”ê°€ í‘œê¸°í•´ì£¼ì„¸ìš”.  í•´ë‹¹ ì»¬ëŸ¼ì€ angelslife_flagë¡œ ë§Œë“¤ì–´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ14ë²ˆ) ëŒ€ì—¬ì¼ìê°€ 2005-06-01~ 14ì¼ì— í•´ë‹¹í•˜ëŠ” ì£¼ë¬¸ ì¤‘ì—ì„œ , ì§ì›ì˜ ì´ë¦„(ì´ë¦„ ì„±) = 'Mike Hillyer' ì´ê±°ë‚˜  ê³ ê°ì˜ ì´ë¦„ì´ (ì´ë¦„ ì„±) ='Gloria Cook'  ì— í•´ë‹¹ í•˜ëŠ” rental ì˜ ëª¨ë“  ì •ë³´ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    - ì¶”ê°€ë¡œ ì§ì›ì´ë¦„ê³¼, ê³ ê°ì´ë¦„ì— ëŒ€í•´ì„œë„ fullname ìœ¼ë¡œ êµ¬ì„±í•´ì„œ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ15ë²ˆ) ëŒ€ì—¬ì¼ìê°€ 2005-06-01~ 14ì¼ì— í•´ë‹¹í•˜ëŠ” ì£¼ë¬¸ ì¤‘ì—ì„œ , ì§ì›ì˜ ì´ë¦„(ì´ë¦„ ì„±) = 'Mike Hillyer' ì— í•´ë‹¹ í•˜ëŠ” ì§ì›ì—ê²Œ  êµ¬ë§¤í•˜ì§€ ì•Šì€  rental ì˜ ëª¨ë“  ì •ë³´ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    - ì¶”ê°€ë¡œ ì§ì›ì´ë¦„ê³¼, ê³ ê°ì´ë¦„ì— ëŒ€í•´ì„œë„ fullname ìœ¼ë¡œ êµ¬ì„±í•´ì„œ ì•Œë ¤ì£¼ì„¸ìš”.
- 3 ì •ë‹µ
    
    ë¬¸ì œ1ë²ˆ) ê³ ê°ì˜ ê¸°ë³¸ ì •ë³´ì¸, ê³ ê° id, ì´ë¦„, ì„±, ì´ë©”ì¼ê³¼ í•¨ê»˜ ê³ ê°ì˜ ì£¼ì†Œ address, district, postal_code, phone ë²ˆí˜¸ë¥¼ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    
    ```sql
    select customer_id, first_name ,last_name, email, customer.address_id, address.district, 
    address.postal_code , address.phone
    from customer
    join address on customer.address_id = address.address_id
    ```
    
    ë¬¸ì œ2ë²ˆ) ê³ ê°ì˜  ê¸°ë³¸ ì •ë³´ì¸, ê³ ê° id, ì´ë¦„, ì„±, ì´ë©”ì¼ê³¼ í•¨ê»˜ ê³ ê°ì˜ ì£¼ì†Œ address, district, postal_code, phone , city ë¥¼ í•¨ê»˜ ì•Œë ¤ì£¼ì„¸ìš”. 	
    
    ```sql
    select customer_id, first_name ,last_name, email, customer.address_id, 
    address.district, address.postal_code , address.phone , city.city
    from customer
    left outer join  address on customer.address_id = address.address_id
    left outer join city on  address.city_id = city.city_id
    ```
    
    ë¬¸ì œ3ë²ˆ) Lima Cityì— ì‚¬ëŠ” ê³ ê°ì˜ ì´ë¦„ê³¼, ì„±, ì´ë©”ì¼, phonenumberì— ëŒ€í•´ì„œ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select first_name ,last_name, email, address.phone
    from customer
    join address on customer.address_id = address.address_id
    join city on  address.city_id = city.city_id
    where city.city ='Lima'
    ```
    
    ë¬¸ì œ4ë²ˆ) rental ì •ë³´ì— ì¶”ê°€ë¡œ, ê³ ê°ì˜ ì´ë¦„ê³¼, ì§ì›ì˜ ì´ë¦„ì„ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    
    - ê³ ê°ì˜ ì´ë¦„, ì§ì› ì´ë¦„ì€ ì´ë¦„ê³¼ ì„±ì„ fullname ì»¬ëŸ¼ìœ¼ë¡œë§Œë“¤ì–´ì„œ ì§ì›ì´ë¦„/ê³ ê°ì´ë¦„ 2ê°œì˜ ì»¬ëŸ¼ìœ¼ë¡œ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select r.*,
    c.first_name , c.last_name ,
    s.first_name , s.last_name
    from rental as r
    left outer join customer as  c on r.customer_id  =  c.customer_id
    left outer join staff s on r.staff_id  = s.staff_id
    
    ```
    
    ë¬¸ì œ5ë²ˆ) [seth.hannon@sakilacustomer.org](mailto:seth.hannon@sakilacustomer.org) ì´ë©”ì¼ ì£¼ì†Œë¥¼ ê°€ì§„ ê³ ê°ì˜  ì£¼ì†Œ address, address2, postal_code, phone, city ì£¼ì†Œë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select address.address,  address.address2, address.postal_code , address.phone , city.city
    from customer
    join address on customer.address_id = address.address_id
    join city on  address.city_id = city.city_id
    where customer.email ='seth.hannon@sakilacustomer.org'
    ```
    
    ë¬¸ì œ6ë²ˆ) Jon Stephens ì§ì›ì„ í†µí•´ dvdëŒ€ì—¬ë¥¼ í•œ payment ê¸°ë¡ ì •ë³´ë¥¼  í™•ì¸í•˜ë ¤ê³  í•©ë‹ˆë‹¤.
    - payment_id,  ê³ ê° ì´ë¦„ ê³¼ ì„±,  rental_id, amount, staff ì´ë¦„ê³¼ ì„±ì„ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select payment_id,
    customer.first_name, customer.last_name ,
    payment.rental_id,  payment.amount,
    
      staff.first_name, staff.last_name
    
    from payment
    join customer  on payment.customer_id = customer.customer_id
    join staff     on payment.staff_id = staff.staff_id
    where staff.first_name ='Jon'
    and staff.last_name ='Stephens'
    ```
    
    ë¬¸ì œ7ë²ˆ) ë°°ìš°ê°€ ì¶œì—°í•˜ì§€ ì•ŠëŠ” ì˜í™”ì˜ film_id, title, release_year, rental_rate, length ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select film.film_id, film.title, release_year, rental_rate,length
    from film
    left outer join film_actor on film.film_id = film_actor.film_id
    left outer join actor  on film_actor.actor_id = actor.actor_id
    where actor.actor_id is null
    ```
    
    ë¬¸ì œ8ë²ˆ) store ìƒì  idë³„ ì£¼ì†Œ (address, address2, distict) ì™€ í•´ë‹¹ ìƒì ì´ ìœ„ì¹˜í•œ city ì£¼ì†Œë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select store.store_id, address.address, address.address2, address.district, city.city
    from store
    left outer join address on store.address_id= address.address_id
    left outer join city on address.city_id = city.city_id
    ```
    
    ë¬¸ì œ9ë²ˆ) ê³ ê°ì˜ id ë³„ë¡œ ê³ ê°ì˜ ì´ë¦„ (first_name, last_name), ì´ë©”ì¼, ê³ ê°ì˜ ì£¼ì†Œ (address, district), phoneë²ˆí˜¸, city, country ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select customer.first_name, customer.last_name, customer.email,
    address.phone,
    country.country,
    city.city
    from customer
    join address on customer.address_id = address.address_id
    join city on address.city_id = city.city_id
    join country on city.country_id = country.country_id
    where country.country  not in ('China')
    ```
    
    ë¬¸ì œ10ë²ˆ) country ê°€ china ê°€ ì•„ë‹Œ ì§€ì—­ì— ì‚¬ëŠ”, ê³ ê°ì˜ ì´ë¦„(first_name, last_name)ê³¼ , email, phonenumber, country, city ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”
    
    ```sql
    select customer.first_name, customer.last_name, customer.email,
    address.phone,
    country.country,
    city.city
    from customer
    join address on customer.address_id = address.address_id
    join city on address.city_id = city.city_id
    join country on city.country_id = country.country_id
    where country.country  not in ('China')
    ```
    
    ë¬¸ì œ11ë²ˆ) Horror ì¹´í…Œê³ ë¦¬ ì¥ë¥´ì— í•´ë‹¹í•˜ëŠ” ì˜í™”ì˜ ì´ë¦„ê³¼ description ì— ëŒ€í•´ì„œ ì•Œë ¤ì£¼ì„¸ìš”
    
    ```sql
    select film.title, film.description
    from film
    join film_category on film.film_id = film_category.film_id
    join category on film_category.category_id= category.category_id
    where [category.name](http://category.name/) ='Horror'
    ```
    
    ë¬¸ì œ12ë²ˆ) Music ì¥ë¥´ì´ë©´ì„œ, ì˜í™”ê¸¸ì´ê°€ 60~180ë¶„ ì‚¬ì´ì— í•´ë‹¹í•˜ëŠ” ì˜í™”ì˜ title, description, length ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    - ì˜í™” ê¸¸ì´ê°€ ì§§ì€ ìˆœìœ¼ë¡œ ì •ë ¬í•´ì„œ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select film.title, film.description, film.length
    from film
    join film_category on film.film_id = film_category.film_id
    join category on film_category.category_id= category.category_id
    where [category.name](http://category.name/) ='Music'	
    and film.length between 60 and 180
    order by length
    ```
    
    ë¬¸ì œ13ë²ˆ) actor í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬,  ë°°ìš°ì˜ ID, ì´ë¦„, ì„± ì»¬ëŸ¼ì— ì¶”ê°€ë¡œ    'Angels Life' ì˜í™”ì— ë‚˜ì˜¨ ì˜í™” ë°°ìš° ì—¬ë¶€ë¥¼ Y , N ìœ¼ë¡œ ì»¬ëŸ¼ì„ ì¶”ê°€ í‘œê¸°í•´ì£¼ì„¸ìš”.  í•´ë‹¹ ì»¬ëŸ¼ì€ angelslife_flagë¡œ ë§Œë“¤ì–´ì£¼ì„¸ìš”.
    
    ```sql
    select a.actor_id , a.first_name, a.last_name , case when a.actor_id in (
    		select actor_id
    		  from film f
    		 inner join film_actor fa 
    			on f.film_id  = fa.film_id
    		 where f.title ='Angels Life') then 'Y'
    		 else 'N'
    		 end as angelslife_flag
      from actor a;
    ```
    
    ë¬¸ì œ14ë²ˆ) ëŒ€ì—¬ì¼ìê°€ 2005-06-01~ 14ì¼ì— í•´ë‹¹í•˜ëŠ” ì£¼ë¬¸ ì¤‘ì—ì„œ , ì§ì›ì˜ ì´ë¦„(ì´ë¦„ ì„±) = 'Mike Hillyer' ì´ê±°ë‚˜  ê³ ê°ì˜ ì´ë¦„ì´ (ì´ë¦„ ì„±) ='Gloria Cook'  ì— í•´ë‹¹ í•˜ëŠ” rental ì˜ ëª¨ë“  ì •ë³´ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    - ì¶”ê°€ë¡œ ì§ì›ì´ë¦„ê³¼, ê³ ê°ì´ë¦„ì— ëŒ€í•´ì„œë„ fullname ìœ¼ë¡œ êµ¬ì„±í•´ì„œ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select r.*,
    c.first_name , c.last_name ,
    s.first_name , s.last_name
    from rental as r 	
    left outer join customer as  c on r.customer_id  =  c.customer_id
    left outer join staff s on r.staff_id  = s.staff_id
    where
    ( s.first_name || ' ' ||s.last_name ='Mike Hillyer'
    or c.first_name  || ' '|| c.last_name  ='Gloria Cook'
    )
    and  date(rental_date) between '2005-06-01' and '2005-06-14'
    ```
    
    ë¬¸ì œ15ë²ˆ) ëŒ€ì—¬ì¼ìê°€ 2005-06-01~ 14ì¼ì— í•´ë‹¹í•˜ëŠ” ì£¼ë¬¸ ì¤‘ì—ì„œ , ì§ì›ì˜ ì´ë¦„(ì´ë¦„ ì„±) = 'Mike Hillyer' ì— í•´ë‹¹ í•˜ëŠ” ì§ì›ì—ê²Œ  êµ¬ë§¤í•˜ì§€ ì•Šì€  rental ì˜ ëª¨ë“  ì •ë³´ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    - ì¶”ê°€ë¡œ ì§ì›ì´ë¦„ê³¼, ê³ ê°ì´ë¦„ì— ëŒ€í•´ì„œë„ fullname ìœ¼ë¡œ êµ¬ì„±í•´ì„œ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select r.*,
    c.first_name , c.last_name ,
    s.first_name , s.last_name
    from rental as r 	
    left outer join customer as  c on r.customer_id  =  c.customer_id
    left outer join staff s on r.staff_id  = s.staff_id
    where
    s.first_name || ' ' ||s.last_name not in ('Mike Hillyer')
    and  date(rental_date) between '2005-06-01' and '2005-06-14'
    ```
    
- 4
    
    ë¬¸ì œ1ë²ˆ) store ë³„ë¡œ staffëŠ” ëª‡ëª…ì´ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ2ë²ˆ) ì˜í™”ë“±ê¸‰(rating) ë³„ë¡œ ëª‡ê°œ ì˜í™”filmì„ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ3ë²ˆ) ì¶œí˜„í•œ ì˜í™”ë°°ìš°(actor)ê°€  10ëª… ì´ˆê³¼í•œ ì˜í™”ëª…ì€ ë¬´ì—‡ì¸ê°€ìš”?
    
    ë¬¸ì œ4ë²ˆ) ì˜í™” ë°°ìš°(actor)ë“¤ì´ ì¶œì—°í•œ ì˜í™”ëŠ” ê°ê° ëª‡ í¸ì¸ê°€ìš”?
    
    - ì˜í™” ë°°ìš°ì˜ ì´ë¦„ , ì„± ê³¼ í•¨ê»˜ ì¶œì—° ì˜í™” ìˆ˜ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ5ë²ˆ) êµ­ê°€(country)ë³„ ê³ ê°(customer) ëŠ” ëª‡ëª…ì¸ê°€ìš”?
    
    ë¬¸ì œ6ë²ˆ) ì˜í™” ì¬ê³  (inventory) ìˆ˜ëŸ‰ì´ 3ê°œ ì´ìƒì¸ ì˜í™”(film) ëŠ”?
    
    - storeëŠ” ìƒê´€ ì—†ì´ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ7ë²ˆ) dvd ëŒ€ì—¬ë¥¼ ì œì¼ ë§ì´í•œ ê³ ê° ì´ë¦„ì€?
    
    ë¬¸ì œ8ë²ˆ) rental í…Œì´ë¸”ì„  ê¸°ì¤€ìœ¼ë¡œ,   2005ë…„ 5ì›”26ì¼ì— ëŒ€ì—¬ë¥¼ ê¸°ë¡í•œ ê³ ê° ì¤‘, í•˜ë£¨ì— 2ë²ˆ ì´ìƒ ëŒ€ì—¬ë¥¼ í•œ ê³ ê°ì˜ ID ê°’ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ9ë²ˆ) film_actor í…Œì´ë¸”ì„ ê¸°ì¤€ìœ¼ë¡œ, ì¶œí˜„í•œ ì˜í™”ì˜ ìˆ˜ê°€ ë§ì€  5ëª…ì˜ actor_id ì™€ , ì¶œí˜„í•œ ì˜í™” ìˆ˜ ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ10ë²ˆ) payment í…Œì´ë¸”ì„ ê¸°ì¤€ìœ¼ë¡œ,  ê²°ì œì¼ìê°€ 2007ë…„2ì›”15ì¼ì— í•´ë‹¹ í•˜ëŠ” ì£¼ë¬¸ ì¤‘ì—ì„œ  ,  í•˜ë£¨ì— 2ê±´ ì´ìƒ ì£¼ë¬¸í•œ ê³ ê°ì˜  ì´ ê²°ì œ ê¸ˆì•¡ì´ 10ë‹¬ëŸ¬ ì´ìƒì¸ ê³ ê°ì— ëŒ€í•´ì„œ ì•Œë ¤ì£¼ì„¸ìš”.
    (ê³ ê°ì˜ id,  ì£¼ë¬¸ê±´ìˆ˜ , ì´ ê²°ì œ ê¸ˆì•¡ê¹Œì§€ ì•Œë ¤ì£¼ì„¸ìš”)
    
    ë¬¸ì œ11ë²ˆ) ì‚¬ìš©ë˜ëŠ” ì–¸ì–´ë³„ ì˜í™” ìˆ˜ëŠ”?
    
    ë¬¸ì œ12ë²ˆ) 40í¸ ì´ìƒ ì¶œì—°í•œ ì˜í™” ë°°ìš°(actor) ëŠ” ëˆ„êµ¬ì¸ê°€ìš”?
    
    ë¬¸ì œ13ë²ˆ) ê³ ê° ë“±ê¸‰ë³„ ê³ ê° ìˆ˜ë¥¼ êµ¬í•˜ì„¸ìš”. (ëŒ€ì—¬ ê¸ˆì•¡ í˜¹ì€ ë§¤ì¶œì•¡  ì— ë”°ë¼ ê³ ê° ë“±ê¸‰ì„ ë‚˜ëˆ„ê³  ì¡°ê±´ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.)
    /*
    A ë“±ê¸‰ì€ 151 ì´ìƒ
    B ë“±ê¸‰ì€ 101 ì´ìƒ 150 ì´í•˜
    C ë“±ê¸‰ì€   51 ì´ìƒ 100 ì´í•˜
    D ë“±ê¸‰ì€   50 ì´í•˜
    
    - ëŒ€ì—¬ ê¸ˆì•¡ì˜ ì†Œìˆ˜ì ì€ ë°˜ì˜¬ë¦¼ í•˜ì„¸ìš”.
    
    HINT
    ë°˜ì˜¬ë¦¼ í•˜ëŠ” í•¨ìˆ˜ëŠ” ROUND ì…ë‹ˆë‹¤.	
    */
    
- 4 ì •ë‹µ
    
    ë¬¸ì œ1ë²ˆ) store ë³„ë¡œ staffëŠ” ëª‡ëª…ì´ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select store_id, count(*) cnt
    from staff
    group by store_id;
    ```
    
    ë¬¸ì œ2ë²ˆ) ì˜í™”ë“±ê¸‰(rating) ë³„ë¡œ ëª‡ê°œ ì˜í™”filmì„ ê°€ì§€ê³  ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select rating , count(*) cnt
    from film
    group by rating;
    ```
    
    ë¬¸ì œ3ë²ˆ) ì¶œí˜„í•œ ì˜í™”ë°°ìš°(actor)ê°€  10ëª… ì´ˆê³¼í•œ ì˜í™”ëª…ì€ ë¬´ì—‡ì¸ê°€ìš”?
    
    ```sql
    select f.title , fc.cnt
    from
    (
    select fa.film_id , count(*) cnt
    from film_actor fa
    group by fa.film_id
    having count(*) > 10
    ) fc
    inner join film f on f.film_id = fc.film_id
    ;
    ```
    
    ë¬¸ì œ4ë²ˆ) ì˜í™” ë°°ìš°(actor)ë“¤ì´ ì¶œì—°í•œ ì˜í™”ëŠ” ê°ê° ëª‡ í¸ì¸ê°€ìš”?
    
    - ì˜í™” ë°°ìš°ì˜ ì´ë¦„ , ì„± ê³¼ í•¨ê»˜ ì¶œì—° ì˜í™” ìˆ˜ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select a.first_name , a.last_name ,fa.cnt
    from
    (
    select fa.actor_id , count(*) cnt
    from film_actor fa
    group by fa.actor_id
    ) fa
    inner join actor a on fa.actor_id = a.actor_id
    ;
    ```
    
    ë¬¸ì œ5ë²ˆ) êµ­ê°€(country)ë³„ ê³ ê°(customer) ëŠ” ëª‡ëª…ì¸ê°€ìš”?
    
    ```sql
    select cy.country , count(*) cnt
    from customer c
    inner join address a  on c.address_id = a.address_id
    inner join city    ct on ct.city_id   = a.city_id
    inner join country cy on ct.country_id = ct.country_id
    group by cy.country;
    ```
    
    ë¬¸ì œ6ë²ˆ) ì˜í™” ì¬ê³  (inventory) ìˆ˜ëŸ‰ì´ 3ê°œ ì´ìƒì¸ ì˜í™”(film) ëŠ”?
    
    - storeëŠ” ìƒê´€ ì—†ì´ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select  f.title , i.cnt
    from
    ( select  film_id ,  count(*) cnt
    from inventory i
    group by  film_id
    having count(*) > 3
    ) i
    inner join film f on f.film_id = i.film_id;
    ```
    
    ë¬¸ì œ7ë²ˆ) dvd ëŒ€ì—¬ë¥¼ ì œì¼ ë§ì´í•œ ê³ ê° ì´ë¦„ì€?
    
    ```sql
    select  c.first_name , c.last_name
    from  customer c inner join
    (
    select p.customer_id , count(p.rental_id) rental_cnt
    from payment p
    group by p.customer_id
    order by rental_cnt desc
    limit 1
    ) p
    on c.customer_id = p.customer_id ;
    ```
    
    ë¬¸ì œ8ë²ˆ) rental í…Œì´ë¸”ì„  ê¸°ì¤€ìœ¼ë¡œ,   2005ë…„ 5ì›”26ì¼ì— ëŒ€ì—¬ë¥¼ ê¸°ë¡í•œ ê³ ê° ì¤‘, í•˜ë£¨ì— 2ë²ˆ ì´ìƒ ëŒ€ì—¬ë¥¼ í•œ ê³ ê°ì˜ ID ê°’ì„ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select customer_id,  count(distinct rental_id) as cnt
    from rental
    where rental_date between '2005-05-26 00:00:00' and '2005-05-26 23:59:59'
    group by customer_id
    having  count(distinct rental_id)  >1
    ```
    
    ë¬¸ì œ9ë²ˆ) film_actor í…Œì´ë¸”ì„ ê¸°ì¤€ìœ¼ë¡œ, ì¶œí˜„í•œ ì˜í™”ì˜ ìˆ˜ê°€ ë§ì€  5ëª…ì˜ actor_id ì™€ , ì¶œí˜„í•œ ì˜í™” ìˆ˜ ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select actor_id , count(distinct film_id) as cnt
    from film_actor
    group by actor_id
    order by cnt desc
    limit 5
    ```
    
    ë¬¸ì œ10ë²ˆ) payment í…Œì´ë¸”ì„ ê¸°ì¤€ìœ¼ë¡œ,  ê²°ì œì¼ìê°€ 2007ë…„2ì›”15ì¼ì— í•´ë‹¹ í•˜ëŠ” ì£¼ë¬¸ ì¤‘ì—ì„œ  ,  í•˜ë£¨ì— 2ê±´ ì´ìƒ ì£¼ë¬¸í•œ ê³ ê°ì˜  ì´ ê²°ì œ ê¸ˆì•¡ì´ 10ë‹¬ëŸ¬ ì´ìƒì¸ ê³ ê°ì— ëŒ€í•´ì„œ ì•Œë ¤ì£¼ì„¸ìš”.
    (ê³ ê°ì˜ id,  ì£¼ë¬¸ê±´ìˆ˜ , ì´ ê²°ì œ ê¸ˆì•¡ê¹Œì§€ ì•Œë ¤ì£¼ì„¸ìš”)
    
    ```sql
    select customer_id , count(distinct rental_id) as cnt, sum(amount) as sum_amount
    from payment
    where payment_date  between '2007-02-15 00:00:00' and '2007-02-15 23:59:59'
    group by customer_id
    having count(distinct rental_id) >=2 and  sum(amount) >=10
    ```
    
    ë¬¸ì œ11ë²ˆ) ì‚¬ìš©ë˜ëŠ” ì–¸ì–´ë³„ ì˜í™” ìˆ˜ëŠ”?
    
    ```sql
    select [l.name](http://l.name/) , count(*) cnt
    from language l
    inner join film f on l.language_id = f.language_id
    group by [l.name](http://l.name/)
    ```
    
    ë¬¸ì œ12ë²ˆ) 40í¸ ì´ìƒ ì¶œì—°í•œ ì˜í™” ë°°ìš°(actor) ëŠ” ëˆ„êµ¬ì¸ê°€ìš”?
    
    ```sql
    select  a.first_name , a.last_name , fc.cnt
    from
    (
    select fc.actor_id, count(*) cnt
    from film_actor fc
    group by fc.actor_id
    having count(*) > 40
    ) fc
    inner join actor a on a.actor_id = fc.actor_id
    ;
    ```
    
    ë¬¸ì œ13ë²ˆ) ê³ ê° ë“±ê¸‰ë³„ ê³ ê° ìˆ˜ë¥¼ êµ¬í•˜ì„¸ìš”. (ëŒ€ì—¬ ê¸ˆì•¡ í˜¹ì€ ë§¤ì¶œì•¡  ì— ë”°ë¼ ê³ ê° ë“±ê¸‰ì„ ë‚˜ëˆ„ê³  ì¡°ê±´ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.)
    /*
    A ë“±ê¸‰ì€ 151 ì´ìƒ
    B ë“±ê¸‰ì€ 101 ì´ìƒ 150 ì´í•˜
    C ë“±ê¸‰ì€   51 ì´ìƒ 100 ì´í•˜
    D ë“±ê¸‰ì€   50 ì´í•˜
    
    - ëŒ€ì—¬ ê¸ˆì•¡ì˜ ì†Œìˆ˜ì ì€ ë°˜ì˜¬ë¦¼ í•˜ì„¸ìš”.
    
    HINT
    ë°˜ì˜¬ë¦¼ í•˜ëŠ” í•¨ìˆ˜ëŠ” ROUND ì…ë‹ˆë‹¤.	
    */
    
    ```sql
    select case when rental_amount <= 50 then 'D'
    when rental_amount between 51  and 100 then 'C'
    when rental_amount between 101 and 150 then 'B'
    when rental_amount >= 151  then 'A' end customer_class
    , count(*) cnt
    from
    (
    select r.customer_id , round(sum(p.amount) ,0) rental_amount
    from rental r
    inner join payment p on p.rental_id = r.rental_id
    group by r.customer_id
    ) r
    group by case when rental_amount <= 50 then 'D'
    when rental_amount between 51  and 100 then 'C'
    when rental_amount between 101 and 150 then 'B'
    when rental_amount >= 151  then 'A' end
    ```
    
- 5
    
    ë¬¸ì œ1ë²ˆ) ì˜í™” ë°°ìš°ê°€,  ì˜í™” 180ë¶„ ì´ìƒì˜ ê¸¸ì´ ì˜ ì˜í™”ì— ì¶œì—°í•˜ê±°ë‚˜, ì˜í™”ì˜ rating ì´ R ì¸ ë“±ê¸‰ì— í•´ë‹¹í•˜ëŠ” ì˜í™”ì— ì¶œì—°í•œ  ì˜í™” ë°°ìš°ì— ëŒ€í•´ì„œ,  ì˜í™” ë°°ìš° ID ì™€ (180ë¶„ì´ìƒ / Rë“±ê¸‰ì˜í™”)ì— ëŒ€í•œ Flag ì»¬ëŸ¼ì„ ì•Œë ¤ì£¼ì„¸ìš”.
    
    - film_actor í…Œì´ë¸”ì™€ film í…Œì´ë¸”ì„ ì´ìš©í•˜ì„¸ìš”.
    - union, unionall, intersect, except ì¤‘ ìƒí™©ì— ë§ê²Œ ì‚¬ìš©í•´ì£¼ì„¸ìš”.
    - actor_id ê°€ ë™ì¼í•œ flag ê°’ ì´ ì—¬ëŸ¬ê°œ ë‚˜ì˜¤ì§€ ì•Šë„ë¡ í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ2ë²ˆ) Rë“±ê¸‰ì˜ ì˜í™”ì— ì¶œì—°í–ˆë˜ ë°°ìš°ì´ë©´ì„œ, ë™ì‹œì—, Alone Tripì˜ ì˜í™”ì— ì¶œì—°í•œ  ì˜í™”ë°°ìš°ì˜ ID ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    - film_actor í…Œì´ë¸”ì™€ film í…Œì´ë¸”ì„ ì´ìš©í•˜ì„¸ìš”.
    - union, unionall, intersect, except ì¤‘ ìƒí™©ì— ë§ê²Œ ì‚¬ìš©í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ3ë²ˆ) G ë“±ê¸‰ì— í•´ë‹¹í•˜ëŠ” í•„ë¦„ì„ ì°ì—ˆìœ¼ë‚˜,   ì˜í™”ë¥¼ 20í¸ì´ìƒ ì°ì§€ ì•Šì€ ì˜í™”ë°°ìš°ì˜ ID ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    - film_actor í…Œì´ë¸”ì™€ film í…Œì´ë¸”ì„ ì´ìš©í•˜ì„¸ìš”.
    - union, unionall, intersect, except ì¤‘ ìƒí™©ì— ë§ê²Œ ì‚¬ìš©í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ4ë²ˆ) í•„ë¦„ ì¤‘ì—ì„œ,  í•„ë¦„ ì¹´í…Œê³ ë¦¬ê°€ Action, Animation, Horror ì— í•´ë‹¹í•˜ì§€ ì•ŠëŠ” í•„ë¦„ ì•„ì´ë””ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    - category í…Œì´ë¸”ì„ ì´ìš©í•´ì„œ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ5ë²ˆ) Staff  ì˜  id , ì´ë¦„, ì„± ì— ëŒ€í•œ ë°ì´í„°ì™€ , Customer ì˜ id, ì´ë¦„ , ì„±ì— ëŒ€í•œ ë°ì´í„°ë¥¼  í•˜ë‚˜ì˜  ë°ì´í„°ì…‹ì˜ í˜•íƒœë¡œ ë³´ì—¬ì£¼ì„¸ìš”.
    
    - ì»¬ëŸ¼ êµ¬ì„± : id, ì´ë¦„ , ì„±, flag (ì§ì›/ê³ ê°ì—¬ë¶€) ë¡œ êµ¬ì„±í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ6ë²ˆ) ì§ì›ê³¼  ê³ ê°ì˜ ì´ë¦„ì´ ë™ì¼í•œ ì‚¬ëŒì´ í˜¹ì‹œ ìˆë‚˜ìš”? ìˆë‹¤ë©´, í•´ë‹¹ ì‚¬ëŒì˜ ì´ë¦„ê³¼ ì„±ì„ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ7ë²ˆ) ë°˜ë‚©ì´ ë˜ì§€ ì•Šì€ ëŒ€ì—¬ì (store)ë³„ ì˜í™” ì¬ê³  (inventory)ì™€ ì „ì²´ ì˜í™” ì¬ê³ ë¥¼ ê°™ì´ êµ¬í•˜ì„¸ìš”. (union all)
    
    ë¬¸ì œ8ë²ˆ) êµ­ê°€(country)ë³„ ë„ì‹œ(city)ë³„ ë§¤ì¶œì•¡, êµ­ê°€(country)ë§¤ì¶œì•¡ ì†Œê³„ ê·¸ë¦¬ê³  ì „ì²´ ë§¤ì¶œì•¡ì„ êµ¬í•˜ì„¸ìš”. (union all)
    
- 5 ì •ë‹µ
    
    ë¬¸ì œ1ë²ˆ) ì˜í™” ë°°ìš°ê°€,  ì˜í™” 180ë¶„ ì´ìƒì˜ ê¸¸ì´ ì˜ ì˜í™”ì— ì¶œì—°í•˜ê±°ë‚˜, ì˜í™”ì˜ rating ì´ R ì¸ ë“±ê¸‰ì— í•´ë‹¹í•˜ëŠ” ì˜í™”ì— ì¶œì—°í•œ  ì˜í™” ë°°ìš°ì— ëŒ€í•´ì„œ,  ì˜í™” ë°°ìš° ID ì™€ (180ë¶„ì´ìƒ / Rë“±ê¸‰ì˜í™”)ì— ëŒ€í•œ Flag ì»¬ëŸ¼ì„ ì•Œë ¤ì£¼ì„¸ìš”.
    
    - film_actor í…Œì´ë¸”ì™€ film í…Œì´ë¸”ì„ ì´ìš©í•˜ì„¸ìš”.
    - union, unionall, intersect, except ì¤‘ ìƒí™©ì— ë§ê²Œ ì‚¬ìš©í•´ì£¼ì„¸ìš”.
    - actor_id ê°€ ë™ì¼í•œ flag ê°’ ì´ ì—¬ëŸ¬ê°œ ë‚˜ì˜¤ì§€ ì•Šë„ë¡ í•´ì£¼ì„¸ìš”.
    
    ```sql
    select actor_id  , 'length_over_180' as flag
    from film_actor fa
    where film_id  in (
    select film_id
    from film
    where length  >=180
    )
    union
    select   actor_id  , 'rating_R' as flag
    from film_actor fa
    where film_id  in (
    select film_id
    from film
    where rating ='R'
    )
    ```
    
    ë¬¸ì œ2ë²ˆ) Rë“±ê¸‰ì˜ ì˜í™”ì— ì¶œì—°í–ˆë˜ ë°°ìš°ì´ë©´ì„œ, ë™ì‹œì—, Alone Tripì˜ ì˜í™”ì— ì¶œì—°í•œ  ì˜í™”ë°°ìš°ì˜ ID ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    - film_actor í…Œì´ë¸”ì™€ film í…Œì´ë¸”ì„ ì´ìš©í•˜ì„¸ìš”.
    - union, unionall, intersect, except ì¤‘ ìƒí™©ì— ë§ê²Œ ì‚¬ìš©í•´ì£¼ì„¸ìš”.
    
    ```sql
    select  actor_id
    from film_actor fa
    where film_id  in (
    select film_id
    from film
    where rating ='R'
    )
    intersect
    
    select actor_id
    from film_actor fa
    where film_id  in (
    select film_id
    from film f
    where title='Alone Trip'
    )
    ```
    
    ë¬¸ì œ3ë²ˆ) G ë“±ê¸‰ì— í•´ë‹¹í•˜ëŠ” í•„ë¦„ì„ ì°ì—ˆìœ¼ë‚˜,   ì˜í™”ë¥¼ 20í¸ì´ìƒ ì°ì§€ ì•Šì€ ì˜í™”ë°°ìš°ì˜ ID ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    - film_actor í…Œì´ë¸”ì™€ film í…Œì´ë¸”ì„ ì´ìš©í•˜ì„¸ìš”.
    - union, unionall, intersect, except ì¤‘ ìƒí™©ì— ë§ê²Œ ì‚¬ìš©í•´ì£¼ì„¸ìš”.
    
    ```sql
    select  actor_id
    from film_actor fa
    where film_id  in (
    select film_id
    from film
    where rating  ='G'
    )
    except
    select actor_id
    from film_actor fa
    group by actor_id
    having count(distinct film_id) >=20
    ```
    
    ë¬¸ì œ4ë²ˆ) í•„ë¦„ ì¤‘ì—ì„œ,  í•„ë¦„ ì¹´í…Œê³ ë¦¬ê°€ Action, Animation, Horror ì— í•´ë‹¹í•˜ì§€ ì•ŠëŠ” í•„ë¦„ ì•„ì´ë””ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    - category í…Œì´ë¸”ì„ ì´ìš©í•´ì„œ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select film_id
    from film
    except
    select film_id
    from film_category fc
    where category_id  in (
    select  category_id
    from category c
    where name  in ('Action','Animation','Horror')
    )
    ```
    
    ë¬¸ì œ5ë²ˆ) Staff  ì˜  id , ì´ë¦„, ì„± ì— ëŒ€í•œ ë°ì´í„°ì™€ , Customer ì˜ id, ì´ë¦„ , ì„±ì— ëŒ€í•œ ë°ì´í„°ë¥¼  í•˜ë‚˜ì˜  ë°ì´í„°ì…‹ì˜ í˜•íƒœë¡œ ë³´ì—¬ì£¼ì„¸ìš”.
    
    - ì»¬ëŸ¼ êµ¬ì„± : id, ì´ë¦„ , ì„±, flag (ì§ì›/ê³ ê°ì—¬ë¶€) ë¡œ êµ¬ì„±í•´ì£¼ì„¸ìš”.
    
    ```sql
    select staff_id,  first_name, last_name ,'Staff' as flag
    from staff
    union all
    select customer_id, first_name , last_name , 'Customer' as flag
    from customer
    ```
    
    ë¬¸ì œ6ë²ˆ) ì§ì›ê³¼  ê³ ê°ì˜ ì´ë¦„ì´ ë™ì¼í•œ ì‚¬ëŒì´ í˜¹ì‹œ ìˆë‚˜ìš”? ìˆë‹¤ë©´, í•´ë‹¹ ì‚¬ëŒì˜ ì´ë¦„ê³¼ ì„±ì„ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select  first_name , last_name
    from customer
    intersect
    select first_name, last_name
    from staff
    ```
    
    ë¬¸ì œ7ë²ˆ) ë°˜ë‚©ì´ ë˜ì§€ ì•Šì€ ëŒ€ì—¬ì (store)ë³„ ì˜í™” ì¬ê³  (inventory)ì™€ ì „ì²´ ì˜í™” ì¬ê³ ë¥¼ ê°™ì´ êµ¬í•˜ì„¸ìš”. (union all)
    
    ```sql
    select null , count(*) cnt
    from rental r
    inner join inventory i on r.inventory_id = i.inventory_id
    where return_date is null
    union all
    select i.store_id , count(*) cnt
    from rental r
    inner join inventory i on r.inventory_id = i.inventory_id
    where return_date is null
    group by i.store_id
    ```
    
    ë¬¸ì œ8ë²ˆ) êµ­ê°€(country)ë³„ ë„ì‹œ(city)ë³„ ë§¤ì¶œì•¡, êµ­ê°€(country)ë§¤ì¶œì•¡ ì†Œê³„ ê·¸ë¦¬ê³  ì „ì²´ ë§¤ì¶œì•¡ì„ êµ¬í•˜ì„¸ìš”. (union all)
    
    select cty.country , ct.city,  sum(p.amount) rental_amount
    from payment p
    inner join customer c on p.customer_id = c.customer_id
    inner join address  a on a.address_id  = c.address_id
    inner join city    ct on ct.city_id    = a.city_id
    inner join country cty on cty.country_id = ct.country_id
    group by cty.country , ct.city
    union all
    select cty.country , null ,  sum(p.amount) rental_amount
    from payment p
    inner join customer c on p.customer_id = c.customer_id
    inner join address  a on a.address_id  = c.address_id
    inner join city    ct on ct.city_id    = a.city_id
    inner join country cty on cty.country_id = ct.country_id
    group by cty.country
    union all
    select null , null ,  sum(p.amount) rental_amount
    from payment p
    inner join customer c on p.customer_id = c.customer_id
    inner join address  a on a.address_id  = c.address_id
    inner join city    ct on ct.city_id    = a.city_id
    inner join country cty on cty.country_id = ct.country_id
    order by 1 , 2
    ;
    

---

### **2ì£¼ì°¨ í€´ì¦ˆ**

- 2ì£¼ì°¨ í€´ì¦ˆ
    
    ![ê¸°ì¡´ í€´ì¦ˆ DBì™€ ê°™ìŒ](S%20Q%20L%20652a8da88475490c9583cc1c305da234/Untitled%2022.png)
    
    ê¸°ì¡´ í€´ì¦ˆ DBì™€ ê°™ìŒ
    
    1.ì£¼ë¬¸ì¼ì´ 2017-09-02 ì¼ì— í•´ë‹¹ í•˜ëŠ” ì£¼ë¬¸ê±´ì— ëŒ€í•´ì„œ,Â  ì–´ë–¤ ê³ ê°ì´, ì–´ë– í•œ ìƒí’ˆì— ëŒ€í•´ì„œ ì–¼ë§ˆë¥¼ ì§€ë¶ˆí•˜ì—¬Â  ìƒí’ˆì„ êµ¬ë§¤í–ˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    
    ```
    
    2.í—¬ë©§ì„ ì£¼ë¬¸í•œ ì  ì—†ëŠ” ê³ ê°ì„ ë³´ì—¬ì£¼ì„¸ìš”.
    
    - í—¬ë§·ì€, Products í…Œì´ë¸”ì˜ productname ì»¬ëŸ¼ì„ ì´ìš©í•´ì„œ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    
    ```
    
    3.ëª¨ë“  ì œí’ˆ ê³¼ ì£¼ë¬¸ ì¼ìë¥¼ ë‚˜ì—´í•˜ì„¸ìš”. (ì£¼ë¬¸ë˜ì§€ ì•Šì€ ì œí’ˆë„ í¬í•¨í•´ì„œ ë³´ì—¬ì£¼ì„¸ìš”.)
    
    ```sql
    
    ```
    
    4.ìº˜ë¦¬í¬ë‹ˆì•„ ì£¼ì™€ ìº˜ë¦¬í¬ë‹ˆì•„ ì£¼ê°€ ì•„ë‹Œ STATS ë¡œ êµ¬ë¶„í•˜ì—¬ ê° ì£¼ë¬¸ëŸ‰ì„ ì•Œë ¤ì£¼ì„¸ìš”. (CASEë¬¸ ì‚¬ìš©)
    
    ```sql
    
    ```
    
    5.ê³µê¸‰ ì—…ì²´ ì™€ íŒë§¤ ì œí’ˆ ìˆ˜ë¥¼ ë‚˜ì—´í•˜ì„¸ìš”. ë‹¨ íŒë§¤ ì œí’ˆìˆ˜ê°€ 2ê°œ ì´ìƒì¸ ê³³ë§Œ ë³´ì—¬ì£¼ì„¸ìš”.
    
    ```sql
    
    ```
    
    1. ê°€ì¥ ë†’ì€ ì£¼ë¬¸ ê¸ˆì•¡ì„ ì‚° ê³ ê°ì€ ëˆ„êµ¬ì¸ê°€ìš”?
    - ì£¼ë¬¸ì¼ìë³„, ê³ ê°ì˜ ì•„ì´ë””ë³„ë¡œ, ì£¼ë¬¸ë²ˆí˜¸, ì£¼ë¬¸ ê¸ˆì•¡ë„ í•¨ê»˜ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    
    ```
    
    7.ì£¼ë¬¸ì¼ìë³„ë¡œ, ì£¼ë¬¸ ê°¯ìˆ˜ì™€,Â  ê³ ê°ìˆ˜ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    - ex) í•˜ë£¨ì— í•œ ê³ ê°ì´ ì£¼ë¬¸ì„ 2ë²ˆì´ìƒí–ˆë‹¤ê³  ê°€ì •í–ˆì„ë•Œ -> í•´ë‹¹ì˜ ê²½ìš°ëŠ” ê³ ê°ìˆ˜ëŠ” 1ëª…ìœ¼ë¡œ ê³„ì‚°í•´ì•¼í•©ë‹ˆë‹¤.
    
    ```sql
    
    ```
    
    8ë²ˆ ìƒëµ
    
    9.íƒ€ì´ì–´ê³¼ í—¬ë©§ì„ ëª¨ë‘ ì‚°ì ì´ ìˆëŠ” ê³ ê°ì˜ ID ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    - íƒ€ì´ì–´ì™€ í—¬ë©§ì— ëŒ€í•´ì„œëŠ” , Products í…Œì´ë¸”ì˜ productname ì»¬ëŸ¼ì„ ì´ìš©í•´ì„œ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    
    ```
    
    1. íƒ€ì´ì–´ëŠ” ìƒ€ì§€ë§Œ, í—¬ë©§ì„ ì‚¬ì§€ ì•Šì€ ê³ ê°ì˜ ID ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”. Except ì¡°ê±´ì„ ì‚¬ìš©í•˜ì—¬, í’€ì´ í•´ì£¼ì„¸ìš”.
    - íƒ€ì´ì–´, í—¬ë©§ì— ëŒ€í•´ì„œëŠ”, Products í…Œì´ë¸”ì˜ productname ì»¬ëŸ¼ì„ ì´ìš©í•´ì„œ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    
    ```
    
- 2ì£¼ì°¨ í€´ì¦ˆ ì •ë‹µ
    
    1.ì£¼ë¬¸ì¼ì´ 2017-09-02 ì¼ì— í•´ë‹¹ í•˜ëŠ” ì£¼ë¬¸ê±´ì— ëŒ€í•´ì„œ,Â  ì–´ë–¤ ê³ ê°ì´, ì–´ë– í•œ ìƒí’ˆì— ëŒ€í•´ì„œ ì–¼ë§ˆë¥¼ ì§€ë¶ˆí•˜ì—¬Â  ìƒí’ˆì„ êµ¬ë§¤í–ˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select o.orderdate, o.customerid, od.productnumber,
    
    od.quotedprice * od.quantityordered as prices
    
    from orders as o
    
    join order_details as od on o.ordernumber = od.ordernumber
    
    where orderdate between '2017-09-02' and '2017-09-02'
    
    order by o.orderdate, o.customerid
    ```
    
    2.í—¬ë©§ì„ ì£¼ë¬¸í•œ ì  ì—†ëŠ” ê³ ê°ì„ ë³´ì—¬ì£¼ì„¸ìš”.
    
    - í—¬ë§·ì€, Products í…Œì´ë¸”ì˜ productname ì»¬ëŸ¼ì„ ì´ìš©í•´ì„œ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select c.customerid
    
    - - , order_hm.customerid
    
    from customers as c
    
    left outer join (
    				
    				select o.ordernumber,o.customerid,Â  od.productnumber, p.productname
    				
    				from orders as o
    				
    				join order_details as od on o.ordernumber= od.ordernumber
    				
    				join products as p on od.productnumber = p.productnumber
    				
    				where p.productname like '%Helmet'
    
    ) as order_hm
    
    on c.customerid = order_hm.customerid
    
    where order_hm.customerid is null
    
    ----------------------------------------
    
    select *
    
    from products as p
    
    where p.productname like '%Helmet%'
    
    where p.productname like '%Tires'
    
    SELECT productnumber,productname FROM products
    
    WHERE productname LIKE '%Helmet%'
    
    - - not like ê°€ ì•ˆë˜ëŠ” ì˜ˆì‹œ
    
    select distinct customer
    
    from (
    
    selectÂ  'tire'Â  as item, 'customer1' as customerÂ Â  union all
    
    selectÂ  'helmet'Â  as item, 'customer1' as customer
    
    ) as db
    
    whereÂ  db.item not like 'helmet'
    ```
    
    3.ëª¨ë“  ì œí’ˆ ê³¼ ì£¼ë¬¸ ì¼ìë¥¼ ë‚˜ì—´í•˜ì„¸ìš”. (ì£¼ë¬¸ë˜ì§€ ì•Šì€ ì œí’ˆë„ í¬í•¨í•´ì„œ ë³´ì—¬ì£¼ì„¸ìš”.)
    
    ```sql
    select p.productnumber, p.productname, od.ordernumber, o.orderdate
    
    from products as p
    
    left outer join order_details as od on p.productnumber = od.productnumber
    
    left outer join orders as oÂ Â  on od.ordernumberÂ  = o.ordernumber
    ```
    
    4.ìº˜ë¦¬í¬ë‹ˆì•„ ì£¼ì™€ ìº˜ë¦¬í¬ë‹ˆì•„ ì£¼ê°€ ì•„ë‹Œ STATS ë¡œ êµ¬ë¶„í•˜ì—¬ ê° ì£¼ë¬¸ëŸ‰ì„ ì•Œë ¤ì£¼ì„¸ìš”. (CASEë¬¸ ì‚¬ìš©)
    
    ```sql
    select db.ca_yn, count(distinct ordernumber) as cnt
    
    from (
    
    select c.customerid, c.custstate,
    
    case when c.custstate ='CA' then 'CA_Y'
    
    else 'CA_N'
    
    end as CA_YN,
    
    o.ordernumber
    
    from customers as c
    
    join orders as o on o.customerid = c.customerid
    
    left outer join order_details as od on o.ordernumber = od.ordernumber
    
    ) as db
    
    group by db.ca_yn
    ```
    
    5.ê³µê¸‰ ì—…ì²´ ì™€ íŒë§¤ ì œí’ˆ ìˆ˜ë¥¼ ë‚˜ì—´í•˜ì„¸ìš”. ë‹¨ íŒë§¤ ì œí’ˆìˆ˜ê°€ 2ê°œ ì´ìƒì¸ ê³³ë§Œ ë³´ì—¬ì£¼ì„¸ìš”.
    
    ```sql
    selectÂ  v.vendname, count(distinct pv.productnumber)
    from product_vendors as pv
    join vendors as v on pv.vendorid = v.vendorid
    group by v.vendname
    having count(distinct pv.productnumber) >= 2
    ```
    
    1. ê°€ì¥ ë†’ì€ ì£¼ë¬¸ ê¸ˆì•¡ì„ ì‚° ê³ ê°ì€ ëˆ„êµ¬ì¸ê°€ìš”?
    - ì£¼ë¬¸ì¼ìë³„, ê³ ê°ì˜ ì•„ì´ë””ë³„ë¡œ, ì£¼ë¬¸ë²ˆí˜¸, ì£¼ë¬¸ ê¸ˆì•¡ë„ í•¨ê»˜ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ```sql
    select orderdate, customerid, ordernumber,sum(prices) as order_price
    from (
    	select o.orderdate, o.customerid, o.ordernumber, od.productnumber,od.quotedprice * od.quantityordered as prices
    	from orders as o
    	join order_details as od 
    	on o.ordernumber = od.ordernumber	
    ) as db
    group by orderdate, customerid , ordernumber
    order by order_price desc
    limit 1
    ```
    
    7.ì£¼ë¬¸ì¼ìë³„ë¡œ, ì£¼ë¬¸ ê°¯ìˆ˜ì™€,Â  ê³ ê°ìˆ˜ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    - ex) í•˜ë£¨ì— í•œ ê³ ê°ì´ ì£¼ë¬¸ì„ 2ë²ˆì´ìƒí–ˆë‹¤ê³  ê°€ì •í–ˆì„ë•Œ -> í•´ë‹¹ì˜ ê²½ìš°ëŠ” ê³ ê°ìˆ˜ëŠ” 1ëª…ìœ¼ë¡œ ê³„ì‚°í•´ì•¼í•©ë‹ˆë‹¤.
    
    ```sql
    select orderdate,Â  count(distinct ordernumber) as cnt_orders,
    
    count(distinct customerid) as cnt_customer
    
    from (
    
    select o.orderdate, o.customerid, o.ordernumber, od.productnumber,
    
    od.quotedprice * od.quantityordered as prices
    
    from orders as o
    
    join order_details as od on o.ordernumber = od.ordernumber
    
    ) as db
    
    group by orderdate
    
    order by orderdate asc
    ```
    
    8ë²ˆ ìƒëµ
    
    9.íƒ€ì´ì–´ê³¼ í—¬ë©§ì„ ëª¨ë‘ ì‚°ì ì´ ìˆëŠ” ê³ ê°ì˜ ID ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    - íƒ€ì´ì–´ì™€ í—¬ë©§ì— ëŒ€í•´ì„œëŠ” , Products í…Œì´ë¸”ì˜ productname ì»¬ëŸ¼ì„ ì´ìš©í•´ì„œ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select o.customerid
    
    from orders as o
    
    join order_details as od
    
    on o.ordernumber = od.ordernumber
    
    join products as p
    
    on od.productnumber =p.productnumber
    
    where p.productname like '%Tires'
    
    intersect
    
    select o.customerid
    
    from orders as o
    
    join order_details as od
    
    on o.ordernumber = od.ordernumber
    
    join products as p
    
    on od.productnumber =p.productnumber
    
    where p.productname like '%Helmet'
    ```
    
    1. íƒ€ì´ì–´ëŠ” ìƒ€ì§€ë§Œ, í—¬ë©§ì„ ì‚¬ì§€ ì•Šì€ ê³ ê°ì˜ ID ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”. Except ì¡°ê±´ì„ ì‚¬ìš©í•˜ì—¬, í’€ì´ í•´ì£¼ì„¸ìš”.
    - íƒ€ì´ì–´, í—¬ë©§ì— ëŒ€í•´ì„œëŠ”, Products í…Œì´ë¸”ì˜ productname ì»¬ëŸ¼ì„ ì´ìš©í•´ì„œ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ```sql
    select o.customerid
    
    from salesordersexample.orders as o
    
    join salesordersexample.order_details as od
    
    on o.ordernumber = od.ordernumber
    
    join salesordersexample.products as p
    
    on od.productnumber =p.productnumber
    
    where p.productname like '%Tires'
    
    except
    
    ------------------------------
    
    select distinctÂ  o.customerid
    
    from salesordersexample.orders as o
    
    join salesordersexample.order_details as od
    
    on o.ordernumber = od.ordernumber
    
    join salesordersexample.products as p
    
    on od.productnumber =p.productnumber
    
    where p.productname like '%Helmet'
    ```
    

---

### **3ì£¼ì°¨ ì‹¤ìŠµë¬¸ì œ**

---

- 6
    
    ë¬¸ì œ1ë²ˆ) ë§¤ì¶œì„ ê°€ì¥ ë§ì´ ì˜¬ë¦° dvd ê³ ê° ì´ë¦„ì€? (subquery í™œìš©)
    
    ë¬¸ì œ2ë²ˆ) ëŒ€ì—¬ê°€ í•œë²ˆë„ì´ë¼ë„ ëœ ì˜í™” ì¹´í…Œ ê³ ë¦¬ ì´ë¦„ì„ ì•Œë ¤ì£¼ì„¸ìš”. (ì¿¼ë¦¬ëŠ”, Existsì¡°ê±´ì„ ì´ìš©í•˜ì—¬ í’€ì–´ë´…ì‹œë‹¤)
    
    ë¬¸ì œ3ë²ˆ) ëŒ€ì—¬ê°€ í•œë²ˆë„ì´ë¼ë„ ëœ ì˜í™” ì¹´í…Œ ê³ ë¦¬ ì´ë¦„ì„ ì•Œë ¤ì£¼ì„¸ìš”. (ì¿¼ë¦¬ëŠ”, Any ì¡°ê±´ì„ ì´ìš©í•˜ì—¬ í’€ì–´ë´…ì‹œë‹¤)
    
    ë¬¸ì œ4ë²ˆ) ëŒ€ì—¬ê°€ ê°€ì¥ ë§ì´ ì§„í–‰ëœ ì¹´í…Œê³ ë¦¬ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (Any, All ì¡°ê±´ ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ì—¬ í’€ì–´ë´…ì‹œë‹¤)
    
    ë¬¸ì œ5ë²ˆ) dvd ëŒ€ì—¬ë¥¼ ì œì¼ ë§ì´í•œ ê³ ê° ì´ë¦„ì€? (subquery í™œìš©)
    
    ë¬¸ì œ6ë²ˆ) ì˜í™” ì¹´í…Œê³ ë¦¬ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì˜í™”ê°€ ìˆë‚˜ìš”?
    
- 6 ì •ë‹µ
    
    ë¬¸ì œ1ë²ˆ) ë§¤ì¶œì„ ê°€ì¥ ë§ì´ ì˜¬ë¦° dvd ê³ ê° ì´ë¦„ì€? (subquery í™œìš©)
    
    ```sql
    selectÂ  first_name , last_name
    from customer c
    whereÂ  customer_id in (
    select customer_id
    from payment p
    group by customer_id
    order by sum(amount) desc
    limit 1
    )
    ```
    
    ë¬¸ì œ2ë²ˆ) ëŒ€ì—¬ê°€ í•œë²ˆë„ì´ë¼ë„ ëœ ì˜í™” ì¹´í…Œ ê³ ë¦¬ ì´ë¦„ì„ ì•Œë ¤ì£¼ì„¸ìš”. (ì¿¼ë¦¬ëŠ”, Existsì¡°ê±´ì„ ì´ìš©í•˜ì—¬ í’€ì–´ë´…ì‹œë‹¤)
    
    ```sql
    select c.name
    from category as c
    where exists (
    	select fc.category_id
    	from rental as r
    	join inventory as i on r.inventory_id = i.inventory_id
    	join film_category as fc on i.film_id = fc.film_id
    	where fc.category_id = c.category_id
    )
    ```
    
    ë¬¸ì œ3ë²ˆ) ëŒ€ì—¬ê°€ í•œë²ˆë„ì´ë¼ë„ ëœ ì˜í™” ì¹´í…Œ ê³ ë¦¬ ì´ë¦„ì„ ì•Œë ¤ì£¼ì„¸ìš”. (ì¿¼ë¦¬ëŠ”, Any ì¡°ê±´ì„ ì´ìš©í•˜ì—¬ í’€ì–´ë´…ì‹œë‹¤)
    
    ```sql
    select c.name
    
    from category as c
    
    where category_id = any (
    
    select fc.category_id
    
    from rental as r
    
    join inventory as i on r.inventory_id = i.inventory_id
    
    join film_category as fc on i.film_id = fc.film_id
    
    )
    ```
    
    ë¬¸ì œ4ë²ˆ) ëŒ€ì—¬ê°€ ê°€ì¥ ë§ì´ ì§„í–‰ëœ ì¹´í…Œê³ ë¦¬ëŠ” ë¬´ì—‡ì¸ê°€ìš”? (Any, All ì¡°ê±´ ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ì—¬ í’€ì–´ë´…ì‹œë‹¤)
    
    ```sql
    select c.*
    
    from category as c
    
    where category_id = any (
    
    	select fc.category_id
    	
    	-- ,Â  count(distinct r.rental_id) as cnt
    	
    	from rental as r
    	
    	join inventory as i on r.inventory_id = i.inventory_id
    	
    	join film_category as fc on i.film_id = fc.film_id
    	
    	group byÂ  fc.category_id
    	
    	order byÂ  count(distinct r.rental_id) desc
    	
    	limit 1
    
    )
    
    ;
    ```
    
    ë¬¸ì œ5ë²ˆ) dvd ëŒ€ì—¬ë¥¼ ì œì¼ ë§ì´í•œ ê³ ê° ì´ë¦„ì€? (subquery í™œìš©)
    
    ```sql
    selectÂ  c.first_name , c.last_name
    
    fromÂ  customer c
    
    where c.customer_id =
    
    (
    
    select p.customer_id
    
    from payment p
    
    group by p.customer_id
    
    order by count(p.rental_id) desc
    
    limit 1
    
    )
    
    ;
    ```
    
    ë¬¸ì œ6ë²ˆ) ì˜í™” ì¹´í…Œê³ ë¦¬ê°’ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì˜í™”ê°€ ìˆë‚˜ìš”?
    
    ```sql
    select *
    
    fromÂ  film as f
    
    where not exists (
    
    select *
    
    from film_category as fc
    
    whereÂ  f.film_idÂ Â  = fc.film_id
    
    );
    ```
    
    /* ì°¸ê³ ì‚¬í•­ */
    
    - - IN, EXISTS ëŠ” í•¨ìˆ˜ëŠ” ë‹¤ë¥´ë‚˜ ë™ì¼í•œ ê²°ê³¼ë¬¼ì„ ë‚´ëŠ” ê²ƒì´ë¼ê³  ìƒê°í•´ë„ ëœë‹¤.
    - - í•˜ì§€ë§Œ NOT IN, NOT EXISTS ëŠ” NULL ì— ì˜í•œ ì°¨ì´ê°€ ì¡´ì¬í•œë‹¤.
    
    ```sql
    select *
    
    from address a
    
    where a.address2 in ( select null )
    
    ;
    
    select *
    
    from address a
    
    where address2Â  not in (
    
    select ''
    
    )
    
    ;
    ```
    
    - -address2 != ''
    - 
    
    ```sql
    select *
    
    from address a
    
    where not existsÂ  (
    
    select 1
    
    from (
    
    select '' as a
    
    ) as db
    
    where db.a = a.address2
    
    )
    
    ;
    ```
    
    in = exists
    
    not in != not existsÂ Â  (ì „ì œì¡°ê±´ì€ null,Â  null ì´ ë°ì´í„°ì…‹ì— ë“¤ì–´ìˆì„ë•ŒëŠ” ê°™ì§€ì•ŠìŒ. ë‹¨ NULLì´ì—†ìœ¼ë©´ ê°™ë‹¤.)
    
    not inÂ  + nullÂ Â  = not exists
    
- 7
    
    ë¬¸ì œ1ë²ˆ) ëŒ€ì—¬ì (store)ë³„ ì˜í™” ì¬ê³ (inventory) ìˆ˜ëŸ‰ê³¼ ì „ì²´ ì˜í™” ì¬ê³  ìˆ˜ëŸ‰ì€? (grouping set)
    
    ë¬¸ì œ2ë²ˆ) ëŒ€ì—¬ì (store)ë³„ ì˜í™” ì¬ê³ (inventory) ìˆ˜ëŸ‰ê³¼ ì „ì²´ ì˜í™” ì¬ê³  ìˆ˜ëŸ‰ì€? (rollup)
    
    ë¬¸ì œ3ë²ˆ) êµ­ê°€(country)ë³„ ë„ì‹œ(city)ë³„ ë§¤ì¶œì•¡, êµ­ê°€(country)ë§¤ì¶œì•¡ ì†Œê³„ ê·¸ë¦¬ê³  ì „ì²´ ë§¤ì¶œì•¡ì„ êµ¬í•˜ì„¸ìš”. (grouping set)
    
    ë¬¸ì œ4ë²ˆ) êµ­ê°€(country)ë³„ ë„ì‹œ(city)ë³„ ë§¤ì¶œì•¡, êµ­ê°€(country)ë§¤ì¶œì•¡ ì†Œê³„ ê·¸ë¦¬ê³  ì „ì²´ ë§¤ì¶œì•¡ì„ êµ¬í•˜ì„¸ìš”. (rollup)
    
    ë¬¸ì œ5ë²ˆ) ì˜í™”ë°°ìš°ë³„ë¡œ  ì¶œì—°í•œ ì˜í™” count ìˆ˜ ì™€,   ëª¨ë“  ë°°ìš°ì˜ ì „ì²´ ì¶œì—° ì˜í™” ìˆ˜ë¥¼ í•©ì‚° í•´ì„œ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    
    ë¬¸ì œ6ë²ˆ) êµ­ê°€ (Country)ë³„, ë„ì‹œ(City)ë³„  ê³ ê°ì˜ ìˆ˜ì™€ ,  ì „ì²´ êµ­ê°€ë³„ ê³ ê°ì˜ ìˆ˜ë¥¼ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”. (grouping sets)
    
    ë¬¸ì œ7ë²ˆ) ì˜í™”ì—ì„œ ì‚¬ìš©í•œ ì–¸ì–´ì™€  ì˜í™” ê°œë´‰ ì—°ë„ ì— ëŒ€í•œ ì˜í™”  ê°¯ìˆ˜ì™€  , ì˜í™” ê°œë´‰ ì—°ë„ì— ëŒ€í•œ ì˜í™” ê°¯ìˆ˜ë¥¼ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    
    ë¬¸ì œ8ë²ˆ) ì—°ë„ë³„, ì¼ë³„ ê²°ì œ  ìˆ˜ëŸ‰ê³¼,  ì—°ë„ë³„ ê²°ì œ ìˆ˜ëŸ‰ì„ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    
    - ê²°ì œìˆ˜ëŸ‰ì€ ê²°ì œ ì˜ id ê°¯ìˆ˜ ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.
    
    ë¬¸ì œ9ë²ˆ) ì§€ì  ë³„,  active ê³ ê°ì˜ ìˆ˜ì™€ ,   active ê³ ê° ìˆ˜ ë¥¼  í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    ì§€ì ê³¼, active ì—¬ë¶€ì— ëŒ€í•´ì„œëŠ” customer í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬ ë³´ì—¬ì£¼ì„¸ìš”.
    
    - grouping sets ë¥¼ ì´ìš©í•´ì„œ í’€ì´í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ10ë²ˆ) ì§€ì  ë³„,  active ê³ ê°ì˜ ìˆ˜ì™€ ,   active ê³ ê° ìˆ˜ ë¥¼  í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    ì§€ì ê³¼, active ì—¬ë¶€ì— ëŒ€í•´ì„œëŠ” customer í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬ ë³´ì—¬ì£¼ì„¸ìš”.
    
    - roll upìœ¼ë¡œ í’€ì´í•´ë³´ë©´ì„œ, grouping sets ê³¼ì˜ ì°¨ì´ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.
- 7 ì •ë‹µ
    
    ë¬¸ì œ1ë²ˆ) ëŒ€ì—¬ì (store)ë³„ ì˜í™” ì¬ê³ (inventory) ìˆ˜ëŸ‰ê³¼ ì „ì²´ ì˜í™” ì¬ê³  ìˆ˜ëŸ‰ì€? (grouping set)
    
    ```sql
    selectÂ  store_id ,Â  count(*) cnt
    
    from inventory i
    
    group by grouping sets ( (store_id) , () );
    ```
    
    ë¬¸ì œ2ë²ˆ) ëŒ€ì—¬ì (store)ë³„ ì˜í™” ì¬ê³ (inventory) ìˆ˜ëŸ‰ê³¼ ì „ì²´ ì˜í™” ì¬ê³  ìˆ˜ëŸ‰ì€? (rollup)
    
    ```sql
    select store_id ,Â  count(*) cnt
    
    from inventory i
    
    group by rollup ( store_id );
    ```
    
    ë¬¸ì œ3ë²ˆ) êµ­ê°€(country)ë³„ ë„ì‹œ(city)ë³„ ë§¤ì¶œì•¡, êµ­ê°€(country)ë§¤ì¶œì•¡ ì†Œê³„ ê·¸ë¦¬ê³  ì „ì²´ ë§¤ì¶œì•¡ì„ êµ¬í•˜ì„¸ìš”. (grouping set)
    
    ```sql
    select cty.country , ct.city,Â  sum(p.amount) rental_amount
    
    from payment p
    
    inner join customer c on p.customer_id = c.customer_id
    
    inner join addressÂ  a on a.address_idÂ  = c.address_id
    
    inner join cityÂ Â Â  ct on ct.city_idÂ Â Â  = a.city_id
    
    inner join country cty on cty.country_id = ct.country_id
    
    group by grouping sets ( (cty.country , ct.city) , (cty.country) , ()Â  )
    
    order by cty.country ,Â  ct.city
    
    ;
    ```
    
    ë¬¸ì œ4ë²ˆ) êµ­ê°€(country)ë³„ ë„ì‹œ(city)ë³„ ë§¤ì¶œì•¡, êµ­ê°€(country)ë§¤ì¶œì•¡ ì†Œê³„ ê·¸ë¦¬ê³  ì „ì²´ ë§¤ì¶œì•¡ì„ êµ¬í•˜ì„¸ìš”. (rollup)
    
    ```sql
    select cty.country , ct.city,Â  sum(p.amount) rental_amount
    
    from payment p
    
    inner join customer c on p.customer_id = c.customer_id
    
    inner join addressÂ  a on a.address_idÂ  = c.address_id
    
    inner join cityÂ Â Â  ct on ct.city_idÂ Â Â  = a.city_id
    
    inner join country cty on cty.country_id = ct.country_id
    
    group by rollup ( cty.country , ct.city )
    
    order by cty.country ,Â  ct.city
    
    ;
    ```
    
    ë¬¸ì œ5ë²ˆ) ì˜í™”ë°°ìš°ë³„ë¡œÂ  ì¶œì—°í•œ ì˜í™” count ìˆ˜ ì™€,Â Â  ëª¨ë“  ë°°ìš°ì˜ ì „ì²´ ì¶œì—° ì˜í™” ìˆ˜ë¥¼ í•©ì‚° í•´ì„œ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    
    ```sql
    select actor_id , count(*)
    
    from film_actor fa
    
    group by rollup(actor_id)
    
    ;
    ```
    
    ë¬¸ì œ6ë²ˆ) êµ­ê°€ (Country)ë³„, ë„ì‹œ(City)ë³„Â  ê³ ê°ì˜ ìˆ˜ì™€ ,Â  ì „ì²´ êµ­ê°€ë³„ ê³ ê°ì˜ ìˆ˜ë¥¼ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”. (grouping sets)
    
    ```sql
    select cty.country , ct.city,Â  count(distinct customer_id) as cnt
    
    fromÂ  customer c
    
    inner join addressÂ  a on a.address_idÂ  = c.address_id
    
    inner join cityÂ Â Â  ct on ct.city_idÂ Â Â  = a.city_id
    
    inner join country cty on cty.country_id = ct.country_id
    
    group by grouping sets ( ( cty.country , ct.city ), ( cty.country ))
    
    order by cty.country ,Â  ct.city
    
    ;
    ```
    
    ë¬¸ì œ7ë²ˆ) ì˜í™”ì—ì„œ ì‚¬ìš©í•œ ì–¸ì–´ì™€Â  ì˜í™” ê°œë´‰ ì—°ë„ ì— ëŒ€í•œ ì˜í™”Â  ê°¯ìˆ˜ì™€Â  , ì˜í™” ê°œë´‰ ì—°ë„ì— ëŒ€í•œ ì˜í™” ê°¯ìˆ˜ë¥¼ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    
    ```sql
    select language_id , release_year , count(film_id)
    
    from film
    
    group by grouping sets ((language_id, release_year), (release_year))
    
    ;
    ```
    
    ë¬¸ì œ8ë²ˆ) ì—°ë„ë³„, ì¼ë³„ ê²°ì œÂ  ìˆ˜ëŸ‰ê³¼,Â  ì—°ë„ë³„ ê²°ì œ ìˆ˜ëŸ‰ì„ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    
    - ê²°ì œìˆ˜ëŸ‰ì€Â  ê²°ì œ ì˜ id ê°¯ìˆ˜ ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.
    
    ```sql
    selectÂ  substring(cast(payment_date as varchar), 1,4) as year ,
    
    substring(cast(payment_date as varchar), 1,10) as date
    
    , count(payment_id) as cnt
    
    from payment p
    
    group by grouping sets(( substring(cast(payment_date as varchar), 1,4), substring(cast(payment_date as varchar), 1,10)),
    
    substring(cast(payment_date as varchar), 1,4))
    
    ;
    ```
    
    ë¬¸ì œ9ë²ˆ) ì§€ì  ë³„,Â  active ê³ ê°ì˜ ìˆ˜ì™€ ,Â Â  active ê³ ê° ìˆ˜ ë¥¼Â  í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    
    ì§€ì ê³¼, active ì—¬ë¶€ì— ëŒ€í•´ì„œëŠ” customer í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬ ë³´ì—¬ì£¼ì„¸ìš”.
    
    ```sql
    -Â  grouping sets ë¥¼ ì´ìš©í•´ì„œ í’€ì´í•´ì£¼ì„¸ìš”.
    
    selectÂ  store_id , active , count(customer_id) as cnt
    
    from customer c
    
    group byÂ  grouping sets((store_id, active),(active))
    
    ;
    ```
    
    ë¬¸ì œ10ë²ˆ) ì§€ì  ë³„,Â  active ê³ ê°ì˜ ìˆ˜ì™€ ,Â Â  active ê³ ê° ìˆ˜ ë¥¼Â  í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.ì§€ì ê³¼
    , active ì—¬ë¶€ì— ëŒ€í•´ì„œëŠ” customer í…Œì´ë¸”ì„ ì´ìš©í•˜ì—¬ ë³´ì—¬ì£¼ì„¸ìš”.
    Â  roll upìœ¼ë¡œ í’€ì´í•´ë³´ë©´ì„œ,Â  grouping sets ê³¼ì˜ ì°¨ì´ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.
    
    ```sql
    
    selectÂ  store_id , active , count(customer_id) as cnt
    
    from customer c
    
    group by rollup(store_id, active)
    
    ;
    ```
    
- 8
    
    ë¬¸ì œ1ë²ˆ) dvd ëŒ€ì—¬ë¥¼ ì œì¼ ë§ì´í•œ ê³ ê° ì´ë¦„ì€? (analytic funtion í™œìš©)
    
    ë¬¸ì œ2ë²ˆ) ë§¤ì¶œì„ ê°€ì¥ ë§ì´ ì˜¬ë¦° dvd ê³ ê° ì´ë¦„ì€? (analytic funtion í™œìš©)
    
    ë¬¸ì œ3ë²ˆ) dvd ëŒ€ì—¬ê°€ ê°€ì¥ ì ì€ ë„ì‹œëŠ”? (anlytic funtion)
    
    ë¬¸ì œ4ë²ˆ) ë§¤ì¶œì´ ê°€ì¥ ì•ˆë‚˜ì˜¤ëŠ” ë„ì‹œëŠ”? (anlytic funtion)
    
    ë¬¸ì œ5ë²ˆ) ì›”ë³„ ë§¤ì¶œì•¡ì„ êµ¬í•˜ê³  ì´ì „ ì›”ë³´ë‹¤ ë§¤ì¶œì•¡ì´ ì¤„ì–´ë“  ì›”ì„ êµ¬í•˜ì„¸ìš”. (ì¼ìëŠ” payment_date ê¸°ì¤€)
    
    ë¬¸ì œ6ë²ˆ) ë„ì‹œë³„ dvd ëŒ€ì—¬ ë§¤ì¶œ ìˆœìœ„ë¥¼ êµ¬í•˜ì„¸ìš”.
    
    ë¬¸ì œ7ë²ˆ) ëŒ€ì—¬ì ë³„ ë§¤ì¶œ ìˆœìœ„ë¥¼ êµ¬í•˜ì„¸ìš”.
    
    ë¬¸ì œ8ë²ˆ) ë‚˜ë¼ë³„ë¡œ ê°€ì¥ ëŒ€ì—¬ë¥¼ ë§ì´í•œ ê³ ê° TOP 5ë¥¼ êµ¬í•˜ì„¸ìš”.
    
    ë¬¸ì œ9ë²ˆ) ì˜í™” ì¹´í…Œê³ ë¦¬ (Category) ë³„ë¡œ ëŒ€ì—¬ê°€ ê°€ì¥ ë§ì´ ëœ ì˜í™” TOP 5ë¥¼ êµ¬í•˜ì„¸ìš”
    
    ë¬¸ì œ10ë²ˆ) ë§¤ì¶œì´ ê°€ì¥ ë§ì€ ì˜í™” ì¹´í…Œê³ ë¦¬ì™€ ë§¤ì¶œì´ ê°€ì¥ ì‘ì€ ì˜í™” ì¹´í…Œê³ ë¦¬ë¥¼ êµ¬í•˜ì„¸ìš”. (first_value, last_value)
    
- 8 ì •ë‹µ
    
    ```sql
    ë¬¸ì œ1ë²ˆ) dvd ëŒ€ì—¬ë¥¼ ì œì¼ ë§ì´í•œ ê³ ê° ì´ë¦„ì€? (analytic funtion í™œìš©)
    
    select c.first_name , c.last_name
    from customer c
         inner join
    	(
    	select p.customer_id , count(p.rental_id) rental_cnt
    	      , row_number() over ( order by count(p.rental_id) desc) rnum
    	  from payment p
    	 group by p.customer_id
    	) p on c.customer_id = p.customer_id
    where p.rnum = 1
     ;
    
    -------------------------------------------------------------------------------------
    ë¬¸ì œ2ë²ˆ) ë§¤ì¶œì„ ê°€ì¥ ë§ì´ ì˜¬ë¦° dvd ê³ ê° ì´ë¦„ì€? (analytic funtion í™œìš©)
    
    select c.first_name , c.last_name
    from customer c
         inner join
    	(
    	select p.customer_id , sum(p.amount) rental_amount
    	      , row_number() over ( order by sum(p.amount) desc) rnum
    	  from payment p
    	 group by p.customer_id
    	) p on c.customer_id = p.customer_id
    where p.rnum = 1
     ;
    
    -------------------------------------------------------------------------------------
    ë¬¸ì œ3ë²ˆ) dvd ëŒ€ì—¬ê°€ ê°€ì¥ ì ì€ ë„ì‹œëŠ”? (anlytic funtion)
    
    select ct.city
      from city ct inner join
    (
    select a.city_id , count(p.rental_id) rental_cnt
           ,row_number() over ( order by count(p.rental_id) ) rnum
      from payment p
           inner join customer c on p.customer_id = c.customer_id
           inner join address  a on a.address_id  = c.address_id
     group by a.city_id
    )  p on ct.city_id = p.city_id
    where p.rnum = 1
    ;
    
    -------------------------------------------------------------------------------------
    ë¬¸ì œ4ë²ˆ) ë§¤ì¶œì´ ê°€ì¥ ì•ˆë‚˜ì˜¤ëŠ” ë„ì‹œëŠ”? (anlytic funtion)
    
    select ct.city
      from city ct inner join
    (
    select a.city_id , sum(p.amount) rental_amount
           ,row_number() over ( order by  sum(p.amount) asc ) rnum
      from payment p
           inner join customer c on p.customer_id = c.customer_id
           inner join address  a on a.address_id  = c.address_id
     group by a.city_id
    )  p on ct.city_id = p.city_id
    where p.rnum = 1
    ;
    
    -------------------------------------------------------------------------------------
    ë¬¸ì œ5ë²ˆ) ì›”ë³„ ë§¤ì¶œì•¡ì„ êµ¬í•˜ê³  ì´ì „ ì›”ë³´ë‹¤ ë§¤ì¶œì•¡ì´ ì¤„ì–´ë“  ì›”ì„ êµ¬í•˜ì„¸ìš”. (ì¼ìëŠ” payment_date ê¸°ì¤€)
    
    select *
    from
    (
    select extract( year from date(p.payment_date)) yr
         , extract(month from date(p.payment_date)) mon
         , sum(amount) amt
         , lag(sum(amount)) over (order by extract(month from date(p.payment_date))) pre_amt
         , sum(amount) - lag(sum(amount)) over (order by extract(month from date(p.payment_date))) gap
      from payment p
     group by extract( year from date(p.payment_date))
            , extract(month from date(p.payment_date))
    ) p
    where gap < 0
     ;
    
    -------------------------------------------------------------------------------------
    ë¬¸ì œ6ë²ˆ) ë„ì‹œë³„ dvd ëŒ€ì—¬ ë§¤ì¶œ ìˆœìœ„ë¥¼ êµ¬í•˜ì„¸ìš”.
    
    select ct.city , sum(p.amount) rental_amount
           ,row_number() over ( order by  sum(p.amount) desc ) rnum
           ,rank()       over ( order by  sum(p.amount) desc ) rnk
           ,dense_rank() over ( order by  sum(p.amount) desc ) drnk
      from payment p
           inner join customer c on p.customer_id = c.customer_id
           inner join address  a on a.address_id  = c.address_id
           inner join city    ct on ct.city_id    = a.city_id
      group by ct.city
    ;
    
    -------------------------------------------------------------------------------------
    ë¬¸ì œ7ë²ˆ) ëŒ€ì—¬ì ë³„ ë§¤ì¶œ ìˆœìœ„ë¥¼ êµ¬í•˜ì„¸ìš”.
    
    select i.store_id , sum(p.amount) rental_amount
           ,row_number() over ( order by  sum(p.amount) desc ) rnum
           ,rank()       over ( order by  sum(p.amount) desc ) rnk
           ,dense_rank() over ( order by  sum(p.amount) desc ) drnk
      from payment p
           inner join rental r    on r.rental_id = p.rental_id
           inner join inventory i on i.inventory_id = r.inventory_id
      group by i.store_id
    ;
    
    -------------------------------------------------------------------------------------
    ë¬¸ì œ8ë²ˆ) ë‚˜ë¼ë³„ë¡œ ê°€ì¥ ëŒ€ì—¬ë¥¼ ë§ì´í•œ ê³ ê° TOP 5ë¥¼ êµ¬í•˜ì„¸ìš”.
    
    select *
    from
    (
    select cty.country , c.first_name, c.last_name , d.customer_id , count(d.rental_id) rental_cnt
           ,row_number() over ( partition by cty.country order by  count(d.rental_id) desc ) rnum
           ,rank()       over ( partition by cty.country order by  count(d.rental_id) desc ) rnk
           ,dense_rank() over ( partition by cty.country order by  count(d.rental_id) desc ) drnk
      from rental  d
           inner join customer c on d.customer_id = c.customer_id
           inner join address  a on a.address_id  = c.address_id
           inner join city    ct on ct.city_id    = a.city_id
           inner join country cty on cty.country_id = ct.country_id
     group by cty.country , c.first_name, c.last_name , d.customer_id
    ) p
    where rnum <= 5
    ;
    
    -------------------------------------------------------------------------------------
    ë¬¸ì œ9ë²ˆ) ì˜í™” ì¹´í…Œê³ ë¦¬ (Category) ë³„ë¡œ ëŒ€ì—¬ê°€ ê°€ì¥ ë§ì´ ëœ ì˜í™” TOP 5ë¥¼ êµ¬í•˜ì„¸ìš”
    
    select *
    from
    (
    select c.name , f.title , count(d.rental_id) rental_cnt
           ,row_number() over ( partition by c.name order by  count(d.rental_id) desc ) rnum
           ,rank()       over ( partition by c.name order by  count(d.rental_id) desc ) rnk
           ,dense_rank() over ( partition by c.name order by  count(d.rental_id) desc ) drnk
      from rental  d
           inner join inventory i on d.inventory_id = i.inventory_id
           inner join film f      on f.film_id = i.film_id
           inner join film_category fc on fc.film_id = f.film_id
           inner join category      c  on c.category_id = fc.category_id
      group by c.name , f.title
    ) p
    where rnum <= 5
    ;
    
    -------------------------------------------------------------------------------------
    
    ë¬¸ì œ10ë²ˆ) ë§¤ì¶œì´ ê°€ì¥ ë§ì€ ì˜í™” ì¹´í…Œê³ ë¦¬ì™€ ë§¤ì¶œì´ ê°€ì¥ ì‘ì€ ì˜í™” ì¹´í…Œê³ ë¦¬ë¥¼ êµ¬í•˜ì„¸ìš”. (first_value, last_value)
    
    select *
    from
    (
    select c.name as category_name  , sum(p.amount) rental_aoumnt ,
              first_value( c.name ) over (order by sum(p.amount) ) min_rental_amount_catagory ,
              last_value( c.name)   over (order by sum(p.amount) range between unbounded preceding  and unbounded following ) max_rental_amount_catagory
    from rental  r
           inner join payment p on r.rental_id = p.rental_id
           inner join inventory i on i.inventory_id = r.inventory_id
           inner join film_category fc on fc.film_id = i.film_id
           inner join category      c  on c.category_id = fc.category_id
    group by c.name
    ) c
    where c.category_name in ( min_rental_amount_catagory , max_rental_amount_catagory )
    ;
    ```
    
- 9
    
    ë¬¸ì œ1ë²ˆ) dvd ëŒ€ì—¬ë¥¼ ì œì¼ ë§ì´í•œ ê³ ê° ì´ë¦„ì€?   (with ë¬¸ í™œìš©)
    
    ë¬¸ì œ2ë²ˆ) ì˜í™” ì‹œê°„ ìœ í˜• (length_type)ì— ëŒ€í•œ ì˜í™” ìˆ˜ë¥¼ êµ¬í•˜ì„¸ìš”.
    ì˜í™” ìƒì˜ ì‹œê°„ ìœ í˜•ì˜ ì •ì˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
    ì˜í™” ê¸¸ì´ (length) ì€ 60ë¶„ ì´í•˜ short , 61ë¶„ ì´ìƒ 120ë¶„ ì´í•˜ middle , 121 ë¶„ì´ìƒ long ìœ¼ë¡œ í•œë‹¤.
    
    ë¬¸ì œ3ë²ˆ) ì•½ì–´ë¡œ í‘œí˜„ë˜ì–´ ìˆëŠ” ì˜í™”ë“±ê¸‰(rating) ì„ ì˜ë¬¸ëª…, í•œê¸€ëª…ê³¼ ê°™ì´ í‘œí˜„í•´ ì£¼ì„¸ìš”. (with ë¬¸ í™œìš©)
    
    G        ? General Audiences (ëª¨ë“  ì—°ë ¹ëŒ€ ì‹œì²­ê°€ëŠ¥)
    PG      ? Parental Guidance Suggested. (ëª¨ë“  ì—°ë ¹ëŒ€ ì‹œì²­ê°€ëŠ¥í•˜ë‚˜, ë¶€ëª¨ì˜ ì§€ë„ê°€ í•„ìš”)
    PG-13 ? Parents Strongly Cautioned (13ì„¸ ë¯¸ë§Œì˜ ì•„ë™ì—ê²Œ ë¶€ì ì ˆ í•  ìˆ˜ ìˆìœ¼ë©°, ë¶€ëª¨ì˜ ì£¼ì˜ë¥¼ ìš”í•¨)
    R         ? Restricted. (17ì„¸ ë˜ëŠ” ê·¸ì´ìƒì˜ ì„±ì¸)
    NC-17 ? No One 17 and Under Admitted.  (17ì„¸ ì´í•˜ ì‹œì²­ ë¶ˆê°€)
    
    ë¬¸ì œ4ë²ˆ) ê³ ê° ë“±ê¸‰ë³„ ê³ ê° ìˆ˜ë¥¼ êµ¬í•˜ì„¸ìš”. (ëŒ€ì—¬ íšŸìˆ˜ì— ë”°ë¼ ê³ ê° ë“±ê¸‰ì„ ë‚˜ëˆ„ê³  ì¡°ê±´ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.)
    
    A ë“±ê¸‰ì€ 31íšŒ ì´ìƒ
    B ë“±ê¸‰ì€ 21íšŒ ì´ìƒ 30íšŒ ì´í•˜
    C ë“±ê¸‰ì€ 11íšŒ ì´ìƒ 20íšŒ ì´í•˜
    D ë“±ê¸‰ì€ 10íšŒ ì´í•˜
    
    ë¬¸ì œ5ë²ˆ) ê³ ê° ì´ë¦„ ë³„ë¡œ , flag  ë¥¼ ë¶™ì—¬ì„œ ë³´ì—¬ì£¼ì„¸ìš”.
    
    - ê³ ê°ì˜ first_name ì´ë¦„ì˜ ì²«ë²ˆì§¸ ê¸€ìê°€, A, B,C ì— í•´ë‹¹ í•˜ëŠ” ì‚¬ëŒì€ ê° A,B,C ë¡œ flag ë¥¼ ë¶™ì—¬ì£¼ì‹œê³ 
    A,B,C ì— í•´ë‹¹í•˜ì§€ ì•ŠëŠ” ì¸ì›ì— ëŒ€í•´ì„œëŠ” Others ë¼ëŠ” flag ë¡œ ë¶™ì—¬ì£¼ì„¸ìš”.
    
    ë¬¸ì œ6ë²ˆ) payment í…Œì´ë¸”ì„ ê¸°ì¤€ìœ¼ë¡œ,  2007ë…„ 1ì›”~ 3ì›” ê¹Œì§€ì˜ ê²°ì œì¼ì— í•´ë‹¹í•˜ë©°,  staff2ë²ˆ ì¸ì›ì—ê²Œ ê²°ì œë¥¼ ì§„í–‰í•œ  ê²°ì œê±´ì— ëŒ€í•´ì„œëŠ”, Y ë¡œ
    ê·¸ ì™¸ì— ëŒ€í•´ì„œëŠ” N ìœ¼ë¡œ í‘œê¸°í•´ì£¼ì„¸ìš”. with ì ˆì„ ì´ìš©í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ7ë²ˆ) Payement í…Œì´ë¸”ì„ ê¸°ì¤€ìœ¼ë¡œ,  ê²°ì œì— ëŒ€í•œ Quarter ë¶„ê¸°ë¥¼ í•¨ê»˜ í‘œê¸°í•´ì£¼ì„¸ìš”.
    with ì ˆì„ í™œìš©í•´ì„œ í’€ì´í•´ì£¼ì„¸ìš”.
    1~ì›”ì˜ ê²½ìš° Q1
    4~6ì›” ì˜ ê²½ìš° Q2
    7~9ì›”ì˜ ê²½ìš° Q3
    10~12ì›”ì˜ ê²½ìš° Q4
    
    ë¬¸ì œ8ë²ˆ) Rental í…Œì´ë¸”ì„ ê¸°ì¤€ìœ¼ë¡œ,  íšŒìˆ˜ì¼ìì— ëŒ€í•œ Quater ë¶„ê¸°ë¥¼ í•¨ê»˜ í‘œê¸°í•´ì£¼ì„¸ìš”.
    with ì ˆì„ í™œìš©í•´ì„œ í’€ì´í•´ì£¼ì„¸ìš”.
    1~ì›”ì˜ ê²½ìš° Q1
    4~6ì›” ì˜ ê²½ìš° Q2
    7~9ì›”ì˜ ê²½ìš° Q3
    10~12ì›”ì˜ ê²½ìš° Q4 ë¡œ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    
    ë¬¸ì œ9ë²ˆ) ì§ì›ì´ì´  ì›”ë³„  ëŒ€ì—¬ë¥¼ ì§„í–‰ í•œ  ëŒ€ì—¬ ê°¯ìˆ˜ê°€ ì–´ë–»ê²Œ ë˜ëŠ” ì§€ ì•Œë ¤ì£¼ì„¸ìš”.
    ëŒ€ì—¬ ìˆ˜ëŸ‰ì´   ì•„ë˜ì— í•´ë‹¹ í•˜ëŠ” ê²½ìš°ì— ëŒ€í•´ì„œ, ê° flag ë¥¼ ì•Œë ¤ì£¼ì„¸ìš” .
    
    0~ 500ê°œ ì˜ ê²½ìš°  under_500
    501~ 3000 ê°œì˜ ê²½ìš°  under_3000
    3001 ~ 99999 ê°œì˜ ê²½ìš°  over_3001
    
    ë¬¸ì œ10ë²ˆ) ì§ì›ì˜ í˜„ì¬ íŒ¨ìŠ¤ì›Œë“œì— ëŒ€í•´ì„œ, ìƒˆë¡œì´  íŒ¨ìŠ¤ì›Œë“œë¥¼ ì§€ì •í•˜ë ¤ê³  í•©ë‹ˆë‹¤.
    ì§ì›1ì˜ ìƒˆë¡œìš´ íŒ¨ìŠ¤ì›Œë“œëŠ” 12345  ,  ì§ì›2ì˜ ìƒˆë¡œìš´ íŒ¨ìŠ¤ì›Œë“œëŠ” 54321ì…ë‹ˆë‹¤.
    í•´ë‹¹ì˜ ê²½ìš°, ì§ì›ë³„ë¡œ ê³¼ê±° íŒ¨ìŠ¤ì›Œë“œì™€ í˜„ì¬ ìƒˆë¡œì´ ì—…ë°ì´íŠ¸í•  íŒ¨ìŠ¤ì›Œë“œë¥¼
    í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    with ì ˆì„ í™œìš©í•˜ì—¬  ìƒˆë¡œìš´ íŒ¨ìŠ¤ì›Œë“œ ì •ë³´ë¥¼ ì €ì¥ í›„ , ì•Œë ¤ì£¼ì„¸ìš”.
    
- 9 ì •ë‹µ
    
    ```sql
    ë¬¸ì œ1ë²ˆ) dvd ëŒ€ì—¬ë¥¼ ì œì¼ ë§ì´í•œ ê³ ê° ì´ë¦„ì€?   (with ë¬¸ í™œìš©)
    
    with rental_customer_rank as  (
                select  r.customer_id , count(*) rental_cnt
                     from rental r
                 group by r.customer_id
    )
    select concat(c.first_name , ' ' , c.last_name) customer_name ,  r.rental_cnt
     from  customer c
               inner join
                    (
                    select r.customer_id , rental_cnt
                          ,row_number() over (order by rental_cnt desc ) rnum
                      from rental_customer_rank r
                    ) r  on c.customer_id = r.customer_id
    where r.rnum = 1
    ;
    
    ë¬¸ì œ2ë²ˆ) ì˜í™” ì‹œê°„ ìœ í˜• (length_type)ì— ëŒ€í•œ ì˜í™” ìˆ˜ë¥¼ êµ¬í•˜ì„¸ìš”.
    ì˜í™” ìƒì˜ ì‹œê°„ ìœ í˜•ì˜ ì •ì˜ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
    ì˜í™” ê¸¸ì´ (length) ì€ 60ë¶„ ì´í•˜ short , 61ë¶„ ì´ìƒ 120ë¶„ ì´í•˜ middle , 121 ë¶„ì´ìƒ long ìœ¼ë¡œ í•œë‹¤.
    
    with  category_flag as (
    
    select 0 as chk1,   60  as chk2 , 'short'  as length_flag  union all
    select 61 as chk1,  120 as chk2, 'middle'  as length_flag  union all
    select 121 as chk1, 999 as chk2, 'long'  as length_flag
    
    )
    
    select f.film_id , f.length ,  cf.length_flag
    from film f
    	 left outer join category_flag as cf  on f.length  between  cf.chk1 and cf.chk2
    ;
    
    ë¬¸ì œ3ë²ˆ) ì•½ì–´ë¡œ í‘œí˜„ë˜ì–´ ìˆëŠ” ì˜í™”ë“±ê¸‰(rating) ì„ ì˜ë¬¸ëª…, í•œê¸€ëª…ê³¼ ê°™ì´ í‘œí˜„í•´ ì£¼ì„¸ìš”. (with ë¬¸ í™œìš©)
    
    G        ? General Audiences (ëª¨ë“  ì—°ë ¹ëŒ€ ì‹œì²­ê°€ëŠ¥)
    PG      ? Parental Guidance Suggested. (ëª¨ë“  ì—°ë ¹ëŒ€ ì‹œì²­ê°€ëŠ¥í•˜ë‚˜, ë¶€ëª¨ì˜ ì§€ë„ê°€ í•„ìš”)
    PG-13 ? Parents Strongly Cautioned (13ì„¸ ë¯¸ë§Œì˜ ì•„ë™ì—ê²Œ ë¶€ì ì ˆ í•  ìˆ˜ ìˆìœ¼ë©°, ë¶€ëª¨ì˜ ì£¼ì˜ë¥¼ ìš”í•¨)
    R         ? Restricted. (17ì„¸ ë˜ëŠ” ê·¸ì´ìƒì˜ ì„±ì¸)
    NC-17 ? No One 17 and Under Admitted.  (17ì„¸ ì´í•˜ ì‹œì²­ ë¶ˆê°€)
    
    with tbl as (
    
    select 'G' as rating, 'General Audiences' as text  union all
    select 'PG' as rating, 'Parental Guidance Suggested' as text  union all
    select 'PG-13' as rating, 'Parents Strongly Cautioned' as text  union all
    select 'R' as rating, 'Restricted' as text  union all
    select 'NC-17' as rating, 'No One 17 and Under Admitted' as text
    )
    
    select f.film_id , f.title , f.rating , t.text
    from film as f
     left outer join tbl as t on cast(f.rating as text) = t.rating
     ;
    
    ë¬¸ì œ4ë²ˆ) ê³ ê° ë“±ê¸‰ë³„ ê³ ê° ìˆ˜ë¥¼ êµ¬í•˜ì„¸ìš”. (ëŒ€ì—¬ íšŸìˆ˜ì— ë”°ë¼ ê³ ê° ë“±ê¸‰ì„ ë‚˜ëˆ„ê³  ì¡°ê±´ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.)
    
    A ë“±ê¸‰ì€ 31íšŒ ì´ìƒ
    B ë“±ê¸‰ì€ 21íšŒ ì´ìƒ 30íšŒ ì´í•˜
    C ë“±ê¸‰ì€ 11íšŒ ì´ìƒ 20íšŒ ì´í•˜
    D ë“±ê¸‰ì€ 10íšŒ ì´í•˜
    
    with  tbl as (
    select 0  as chk1 , 10 as chk2   , 'D' as grade union all
    select 11 as chk1 , 20 as chk2   , 'C' as grade union all
    select 21 as chk1 , 30 as chk2   , 'B' as grade union all
    select 31 as chk1 , 99 as chk2   , 'A' as grade
    
    )
    
    select tbl.grade,  count(customer_id) as  cnt
    from
            (
             select customer_id , count(*) rental_cnt
               from rental r
              group by customer_id
              order by rental_cnt desc
            ) r
            left outer join tbl on r.rental_cnt between  tbl.chk1 and tbl.chk2
    group by tbl.grade
    ;
    
    ë¬¸ì œ5ë²ˆ) ê³ ê° ì´ë¦„ ë³„ë¡œ , flag  ë¥¼ ë¶™ì—¬ì„œ ë³´ì—¬ì£¼ì„¸ìš”.
    - ê³ ê°ì˜ first_name ì´ë¦„ì˜ ì²«ë²ˆì§¸ ê¸€ìê°€, A, B,C ì— í•´ë‹¹ í•˜ëŠ” ì‚¬ëŒì€  ê° A,B,C ë¡œ flag ë¥¼ ë¶™ì—¬ì£¼ì‹œê³ 
       A,B,C ì— í•´ë‹¹í•˜ì§€ ì•ŠëŠ” ì¸ì›ì— ëŒ€í•´ì„œëŠ” Others ë¼ëŠ” flag ë¡œ  ë¶™ì—¬ì£¼ì„¸ìš”.
    
    with tbl as (
    
    select  'A' as first_name  union all
    select  'B' as first_name  union all
    select  'C' as first_name
    )
    
    select c.*, coalesce(tbl.first_name ,'Others') as flag
    from customer c
    	 left outer join tbl  on substring(c.first_name,1,1) = tbl.first_name
    ;
    
    ë¬¸ì œ6ë²ˆ) payment í…Œì´ë¸”ì„ ê¸°ì¤€ìœ¼ë¡œ,  2007ë…„ 1ì›”~ 3ì›” ê¹Œì§€ì˜ ê²°ì œì¼ì— í•´ë‹¹í•˜ë©°,  staff2ë²ˆ ì¸ì›ì—ê²Œ ê²°ì œë¥¼ ì§„í–‰í•œ  ê²°ì œê±´ì— ëŒ€í•´ì„œëŠ”, Y ë¡œ
    ê·¸ ì™¸ì— ëŒ€í•´ì„œëŠ” N ìœ¼ë¡œ í‘œê¸°í•´ì£¼ì„¸ìš”. with ì ˆì„ ì´ìš©í•´ì£¼ì„¸ìš”.
    
    with  tbl as (
    
    select 2 as staff_id, cast('2007-01-01 00:00:00' as timestamp) as chk1 , cast('2007-03-31 23:59:59' as timestamp) as chk2
    )
    
    select p.*,
    		case  when tbl.staff_id is not null then 'Y'  else 'N' end flag
    from payment p
    	 left outer join tbl  on p.payment_date  between  tbl.chk1 and tbl.chk2
    	 						and p.staff_id  = tbl.staff_id
    ;
    
    ë¬¸ì œ7ë²ˆ) Payement í…Œì´ë¸”ì„ ê¸°ì¤€ìœ¼ë¡œ,  ê²°ì œì— ëŒ€í•œ Quarter ë¶„ê¸°ë¥¼ í•¨ê»˜ í‘œê¸°í•´ì£¼ì„¸ìš”.
    with ì ˆì„ í™œìš©í•´ì„œ í’€ì´í•´ì£¼ì„¸ìš”.
    1~ì›”ì˜ ê²½ìš° Q1
    4~6ì›” ì˜ ê²½ìš° Q2
    7~9ì›”ì˜ ê²½ìš° Q3
    10~12ì›”ì˜ ê²½ìš° Q4
    
    with  tbl as (
    
    select cast('2007-01-01 00:00:00' as timestamp) as chk1 , cast('2007-03-31 23:59:59' as timestamp) as chk2 , 'Q1' as quarter union all
    select cast('2007-04-01 00:00:00' as timestamp) as chk1 , cast('2007-06-30 23:59:59' as timestamp) as chk2 , 'Q2' as quarter union all
    select cast('2007-07-01 00:00:00' as timestamp) as chk1 , cast('2007-09-30 23:59:59' as timestamp) as chk2 , 'Q3' as quarter union all
    select cast('2007-10-01 00:00:00' as timestamp) as chk1 , cast('2007-12-31 23:59:59' as timestamp) as chk2 , 'Q4' as quarter
    )
    
    select p.*,
    		tbl.quarter
    from payment p
    	 left outer join tbl  on p.payment_date  between  tbl.chk1 and tbl.chk2
    ;
    
    ë¬¸ì œ8ë²ˆ) Rental í…Œì´ë¸”ì„ ê¸°ì¤€ìœ¼ë¡œ,  íšŒìˆ˜ì¼ìì— ëŒ€í•œ Quater ë¶„ê¸°ë¥¼ í•¨ê»˜ í‘œê¸°í•´ì£¼ì„¸ìš”.
    with ì ˆì„ í™œìš©í•´ì„œ í’€ì´í•´ì£¼ì„¸ìš”.
    1~ì›”ì˜ ê²½ìš° Q1
    4~6ì›” ì˜ ê²½ìš° Q2
    7~9ì›”ì˜ ê²½ìš° Q3
    10~12ì›”ì˜ ê²½ìš° Q4 ë¡œ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    
    with  tbl as (
    
    select cast('2007-01-01 00:00:00' as timestamp) as chk1 , cast('2007-03-31 23:59:59' as timestamp) as chk2 , 'Q1' as quarter union all
    select cast('2007-04-01 00:00:00' as timestamp) as chk1 , cast('2007-06-30 23:59:59' as timestamp) as chk2 , 'Q2' as quarter union all
    select cast('2007-07-01 00:00:00' as timestamp) as chk1 , cast('2007-09-30 23:59:59' as timestamp) as chk2 , 'Q3' as quarter union all
    select cast('2007-10-01 00:00:00' as timestamp) as chk1 , cast('2007-12-31 23:59:59' as timestamp) as chk2 , 'Q4' as quarter
    )
    
    select r.*,  tbl.quarter
    from rental r
             left outer join tbl  on r.return_date  between  tbl.chk1 and tbl.chk2
    ;
    
    ë¬¸ì œ9ë²ˆ) ì§ì›ì´ì´  ì›”ë³„  ëŒ€ì—¬ë¥¼ ì§„í–‰ í•œ  ëŒ€ì—¬ ê°¯ìˆ˜ê°€ ì–´ë–»ê²Œ ë˜ëŠ” ì§€ ì•Œë ¤ì£¼ì„¸ìš”.
    ëŒ€ì—¬ ìˆ˜ëŸ‰ì´   ì•„ë˜ì— í•´ë‹¹ í•˜ëŠ” ê²½ìš°ì— ëŒ€í•´ì„œ, ê° flag ë¥¼ ì•Œë ¤ì£¼ì„¸ìš” .
    
    0~ 500ê°œ ì˜ ê²½ìš°  under_500
    501~ 3000 ê°œì˜ ê²½ìš°  under_3000
    3001 ~ 99999 ê°œì˜ ê²½ìš°  over_3001
    
    with tbl as (
    
    select   0 as chk1,  500 as chk2  , 'under_500' as flag union all
    select   501 as chk1,  3000 as chk2  , 'under_3000' as flag union all
    select   3001 as chk1,  99999 as chk2  , 'over_3001' as flag
    )
    
    select db.*, tbl.flag
    from (
                            select substring(cast(rental_date as varchar),1,7) as rental_mon,
                                            staff_id , count(rental_id) as cnt
                            from rental r
                            group by  substring(cast(rental_date as varchar),1,7),
                                            staff_id
            ) as db
            left outer join tbl  on db.cnt between tbl.chk1 and tbl.chk2
    ;
    
    ë¬¸ì œ10ë²ˆ) ì§ì›ì˜ í˜„ì¬ íŒ¨ìŠ¤ì›Œë“œì— ëŒ€í•´ì„œ, ìƒˆë¡œì´  íŒ¨ìŠ¤ì›Œë“œë¥¼ ì§€ì •í•˜ë ¤ê³  í•©ë‹ˆë‹¤.
    ì§ì›1ì˜ ìƒˆë¡œìš´ íŒ¨ìŠ¤ì›Œë“œëŠ” 12345  ,  ì§ì›2ì˜ ìƒˆë¡œìš´ íŒ¨ìŠ¤ì›Œë“œëŠ” 54321ì…ë‹ˆë‹¤.
    í•´ë‹¹ì˜ ê²½ìš°, ì§ì›ë³„ë¡œ ê³¼ê±° íŒ¨ìŠ¤ì›Œë“œì™€ í˜„ì¬ ìƒˆë¡œì´ ì—…ë°ì´íŠ¸í•  íŒ¨ìŠ¤ì›Œë“œë¥¼
    í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    with ì ˆì„ í™œìš©í•˜ì—¬  ìƒˆë¡œìš´ íŒ¨ìŠ¤ì›Œë“œ ì •ë³´ë¥¼ ì €ì¥ í›„ , ì•Œë ¤ì£¼ì„¸ìš”.
    
    with new_password as (
    
    select 1 as staff_id  , '12345' as new_pwd union all
    select 2 as staff_id  , '54321' as new_pwd
    
    )
    
    select s.staff_id , s.password ,    np.new_pwd
    from staff s
             join  new_password as np on s.staff_id  = np.staff_id
    ;
    ```
    

---

### 3ì£¼ì°¨ í€´ì¦ˆ

- 3ì£¼ì°¨ í€´ì¦ˆ
    
    ```sql
    ë¬¸ì œ1ë²ˆ) 4ê°œì´ìƒì˜ ì—…ì²´ì—ì„œ íŒë§¤í•˜ëŠ” ìƒí’ˆë²ˆí˜¸ê°€ ë¬´ì—‡ì¸ì§€ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ2ë²ˆ) ì£¼ë¬¸ì¼ìë³„, ê³ ê°ì˜ ì•„ì´ë””ë³„ë¡œ, ì£¼ë¬¸ë²ˆí˜¸ì— í•´ë‹¹í•˜ëŠ” ì£¼ë¬¸ ê¸ˆì•¡ì€ ì–¼ë§ˆì¸ê°€ìš”?
    
    ë¬¸ì œ3ë²ˆ) ê³ ê°ì˜ ì´ë¦„ê³¼, ì§ì›ì˜ ì •ë³´ë¥¼ í•˜ë‚˜ì˜ ì´ë¦„ ì •ë³´ë¡œ ë³´ì—¬ì£¼ì„¸ìš”.
    - ë‹¨ ì´ë¦„ê³¼ íƒ€ì…ìœ¼ë¡œ ì»¬ëŸ¼ì„ êµ¬ì„±í•˜ì—¬ íƒ€ì…ì€ ê³ ê°/ì§ì›ì˜ íƒ€ì…ì— ë”°ë¼ ê°ê° customer, staffìœ¼ë¡œ ê°’ì„ ë„£ì–´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ4ë²ˆ) 1ë²ˆ ì£¼ë¬¸ ë²ˆí˜¸ì— ëŒ€í•´ì„œ, ìƒí’ˆëª…, ì£¼ë¬¸ ê¸ˆì•¡ê³¼ 1ë²ˆ ì£¼ë¬¸ ê¸ˆì•¡ì— ëŒ€í•œ ì´ êµ¬ë§¤ê¸ˆì•¡ì„ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    
    ë¬¸ì œ5ë²ˆ) í—¬ë©§ì„ ì£¼ë¬¸í•œ ëª¨ë“  ê³ ê°ê³¼ ìì „ê±°ë¥¼ ì£¼ë¬¸í•œ ëª¨ë“  ê³ ê°ì„ ë‚˜ì—´í•˜ì„¸ìš”. (Union í™œìš©) í—¬ë©§ê³¼ ìì „ê±°ëŠ” Products í…Œì´ë¸”ì˜ productname ì»¬ëŸ¼ì„ ì´ìš©í•´ì„œ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    ë¬¸ì œ6ë²ˆ) ê³ ê°ì´ êµ¬ë§¤ ì œí’ˆì˜ ê°€ê²©ì´, í‰ê·  ì œí’ˆ ì†Œë§¤ ê°€ê²©ë³´ë‹¤ ë†’ì€ ì œí’ˆì˜ ì´ë¦„ê³¼ ë²ˆí˜¸ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ7ë²ˆ) ì£¼ë¬¸ì¼ìê°€ 2017/09/01 ~ 2017/09/30 ì¼ì— í•´ë‹¹í•˜ëŠ” ì£¼ë¬¸ì— ëŒ€í•´ì„œ
    ì£¼ë¬¸ì¼ìì™€ ê³ ê°ë³„ë¡œ ì£¼ë¬¸ ìˆ˜ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    ë˜í•œ ê³ ê°ë³„ ì£¼ë¬¸ ìˆ˜ë„ í•¨ê»˜ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ8ë²ˆ) ì£¼ë¬¸ì¼ìê°€ 2017/09/01 ~ 2017/09/30ì¼ì— í•´ë‹¹í•˜ëŠ” ì£¼ë¬¸ì— ëŒ€í•´ì„œ,
    ì£¼ë¬¸ì¼ìì™€ ê³ ê°ë³„ë¡œ ì£¼ë¬¸ ìˆ˜ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
    ë˜í•œ ì£¼ë¬¸ì¼ìë³„ ì£¼ë¬¸ ìˆ˜ë„ í•¨ê»˜ ì•Œë ¤ì£¼ì‹œê³ , ì „ì²´ ì£¼ë¬¸ ìˆ˜ë„ í•¨ê»˜ ì•Œë ¤ì£¼ì„¸ìš”.
    
    ë¬¸ì œ9ë²ˆ) 2017ë…„ë„ì˜ ì£¼ë¬¸ì¼ ë³„ ì£¼ë¬¸ ê¸ˆì•¡ê³¼, ì›”ë³„ ì£¼ë¬¸ ì´ ê¸ˆì•¡ì„ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.
    ë™ì‹œì— ì¼ë³„ ì£¼ë¬¸ ê¸ˆì•¡ì´ ì›”ë³„ ì£¼ë¬¸ ê¸ˆì•¡ì— í•´ë‹¹í•˜ëŠ” ë¹„ìœ¨ì„ ê°™ì´ ë³´ì—¬ì£¼ì„¸ìš”. (analytic function í™œìš©)
    
    ë¬¸ì œ10ë²ˆ) ì£¼ë¬¸ì„ ë§ì´ í•œ ê³ ê° ìˆœì„œ ëŒ€ë¡œ ìˆœìœ„ë¥¼ ë§¤ê²¨ ë‚˜ì—´í•˜ì„¸ìš”. (analytic function í™œìš©)
    - ê°™ì€ ì£¼ë¬¸ ìˆ˜ì¹˜ ì¼ ë•Œ, ê°™ì€ ë“±ìˆ˜ë¡œ ë³´ì—¬ì£¼ì„¸ìš”.
    
    ```
    
- 3ì£¼ì°¨ í€´ì¦ˆ ì •ë‹µ
    
    ```sql
    ë¬¸ì œ1ë²ˆ) 4ê°œì´ìƒì˜ ì—…ì²´ì—ì„œ íŒë§¤í•˜ëŠ” ìƒí’ˆë²ˆí˜¸ê°€ ë¬´ì—‡ì¸ì§€ ì•Œë ¤ì£¼ì„¸ìš”.
    
    select productnumber , count(distinct vendorid) as cnt_vendor
    from product_vendors pv 
    group by productnumber 
    having count(distinct vendorid) >3
    
    ë¬¸ì œ2ë²ˆ) ì£¼ë¬¸ì¼ìë³„, ê³ ê°ì˜ ì•„ì´ë””ë³„ë¡œ, ì£¼ë¬¸ë²ˆí˜¸ì— í•´ë‹¹í•˜ëŠ” ì£¼ë¬¸ ê¸ˆì•¡ì€ ì–¼ë§ˆì¸ê°€ìš”?
    
    select orderdate, customerid, ordernumber,sum(prices) as order_price
    from (
            select o.orderdate, o.customerid, o.ordernumber, od.productnumber,
                            od.quotedprice * od.quantityordered as prices
            from orders as o
                 join order_details as od on o.ordernumber = od.ordernumber
    ) as db  
    group by orderdate, customerid , ordernumber
    
    ë¬¸ì œ3ë²ˆ) ê³ ê°ì˜ ì´ë¦„ê³¼, ì§ì›ì˜ ì •ë³´ë¥¼ í•˜ë‚˜ì˜ ì´ë¦„ ì •ë³´ë¡œ ë³´ì—¬ì£¼ì„¸ìš”. 
    - ë‹¨ ì´ë¦„ê³¼ íƒ€ì…ìœ¼ë¡œ ì»¬ëŸ¼ì„ êµ¬ì„±í•˜ì—¬ íƒ€ì…ì€ ê³ ê°/ì§ì›ì˜ íƒ€ì…ì— ë”°ë¼ ê°ê° customer, staffìœ¼ë¡œ ê°’ì„ ë„£ì–´ì£¼ì„¸ìš”.
    
    select custfirstname ||', '|| custlastname  as  customer , 'Customer' as type
    from customers 
    union all -- (ë˜ëŠ”  union )
    select  empfirstname ||', '|| emplastname  as  staff , 'Staff' as type 
    from employees e 
    
    ë¬¸ì œ4ë²ˆ) 1ë²ˆ ì£¼ë¬¸ ë²ˆí˜¸ì— ëŒ€í•´ì„œ, ìƒí’ˆëª…, ì£¼ë¬¸ ê¸ˆì•¡ê³¼ 1ë²ˆ ì£¼ë¬¸ ê¸ˆì•¡ì— ëŒ€í•œ ì´ êµ¬ë§¤ê¸ˆì•¡ì„ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”. 
    
    select ordernumber , customerid , null as productnumber , sum(prices) as price 
    from (
            select o.orderdate, o.customerid, o.ordernumber, od.productnumber,
                            od.quotedprice * od.quantityordered as prices
            from orders as o
                 join order_details as od on o.ordernumber = od.ordernumber
            where o.ordernumber =1 
    ) as db 
    group by ordernumber , customerid , ordernumber
    
    union all 
    
    select  ordernumber , customerid  , productnumber ,prices 
    from (
            select o.orderdate, o.customerid, o.ordernumber, od.productnumber,
                            od.quotedprice * od.quantityordered as prices
            from orders as o
                 join order_details as od on o.ordernumber = od.ordernumber
            where o.ordernumber =1 
    ) as db 
    
    ë¬¸ì œ5ë²ˆ) í—¬ë©§ì„ ì£¼ë¬¸í•œ ëª¨ë“  ê³ ê°ê³¼ ìì „ê±°ë¥¼ ì£¼ë¬¸í•œ ëª¨ë“  ê³ ê°ì„ ë‚˜ì—´í•˜ì„¸ìš”. (Union í™œìš©) í—¬ë©§ê³¼ ìì „ê±°ëŠ” Products í…Œì´ë¸”ì˜ productname ì»¬ëŸ¼ì„ ì´ìš©í•´ì„œ í™•ì¸í•´ì£¼ì„¸ìš”.
    
    select o.customerid
            from orders as o 
                 join order_details as od
     on o.ordernumber = od.ordernumber
                 join products as p 
    on od.productnumber =p.productnumber
            where p.productname like '%Bike'
    union 
    select o.customerid
            from orders as o 
                 join order_details as od 
    on o.ordernumber = od.ordernumber
                 join products as p 
    on od.productnumber =p.productnumber
            where p.productname like '%Helmet'
    
    --27ê°œ ROW         
            
            
            
            
            
            
            
            
            
            
            
    ë¬¸ì œ6ë²ˆ) ê³ ê°ì´ êµ¬ë§¤ ì œí’ˆì˜ ê°€ê²©ì´, í‰ê·  ì œí’ˆ ì†Œë§¤ ê°€ê²©ë³´ë‹¤ ë†’ì€ ì œí’ˆì˜ ì´ë¦„ê³¼ ë²ˆí˜¸ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.
    
    select distinct od.productnumber, p.productname , od.quotedprice
    from order_details as od 
          join products as p on od.productnumber = p.productnumber
    where od.quotedprice >= (select avg(p.retailprice) as avg_p
                                    from products  as p )
                                    
                         
     1,2,6,11                         
                                      
                                
     
     select productnumber ,retailprice,  avg(retailprice) 
     from products p 
     group by productnumber ,retailprice
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
    
    ë¬¸ì œ7ë²ˆ) ì£¼ë¬¸ì¼ìê°€ 2017/09/01 ~ 2017/09/30 ì¼ì— í•´ë‹¹í•˜ëŠ” ì£¼ë¬¸ì— ëŒ€í•´ì„œ
    ì£¼ë¬¸ì¼ìì™€ ê³ ê°ë³„ë¡œ ì£¼ë¬¸ ìˆ˜ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”. 
    ë˜í•œ ê³ ê°ë³„ ì£¼ë¬¸ ìˆ˜ë„ í•¨ê»˜ ì•Œë ¤ì£¼ì„¸ìš”.
    
    select orderdate , customerid , count(distinct ordernumber) as cnt 
    from orders o 
    where orderdate  between '2017-09-01' and '2017-09-30'
    group by grouping sets ((orderdate,customerid), (customerid))
    
    --168ê°œ 
    
    ë¬¸ì œ8ë²ˆ) ì£¼ë¬¸ì¼ìê°€ 2017/09/01 ~ 2017/09/30ì¼ì— í•´ë‹¹í•˜ëŠ” ì£¼ë¬¸ì— ëŒ€í•´ì„œ, 
    ì£¼ë¬¸ì¼ìì™€ ê³ ê°ë³„ë¡œ ì£¼ë¬¸ ìˆ˜ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”. 
    ë˜í•œ ì£¼ë¬¸ì¼ìë³„ ì£¼ë¬¸ ìˆ˜ë„ í•¨ê»˜ ì•Œë ¤ì£¼ì‹œê³ , ì „ì²´ ì£¼ë¬¸ ìˆ˜ë„ í•¨ê»˜ ì•Œë ¤ì£¼ì„¸ìš”.
    
    select orderdate , customerid , count(distinct ordernumber) as cnt 
    from orders o 
    where orderdate  between '2017-09-01' and '2017-09-30'
    group by rollup (orderdate,customerid)
    
    --172ê°œ 
    
    ë¬¸ì œ9ë²ˆ) 2017ë…„ë„ì˜ ì£¼ë¬¸ì¼ ë³„ ì£¼ë¬¸ ê¸ˆì•¡ê³¼, ì›”ë³„ ì£¼ë¬¸ ì´ ê¸ˆì•¡ì„ í•¨ê»˜ ë³´ì—¬ì£¼ì„¸ìš”. 
    ë™ì‹œì— ì¼ë³„ ì£¼ë¬¸ ê¸ˆì•¡ì´ ì›”ë³„ ì£¼ë¬¸ ê¸ˆì•¡ì— í•´ë‹¹í•˜ëŠ” ë¹„ìœ¨ì„ ê°™ì´ ë³´ì—¬ì£¼ì„¸ìš”. (analytic function í™œìš©)
    
    select orderdate, 
               sum(product_price) over (partition by orderdate ) as day_price ,
               sum(product_price) over (partition by mm ) as monthly_price,
               sum(product_price) over (partition by orderdate )  / 
               sum(product_price) over (partition by mm )  as perc
    from (
           select mm , orderdate , sum(product_price) product_price
           from 
                   (
                            select o.ordernumber, orderdate, EXTRACT(month from o.orderdate) as mm, 
                                       od.productnumber, od.quotedprice * od.quantityordered as product_price
                            from orders as o 
                                 join order_details as od  on o.ordernumber= od.ordernumber 
                            where o.orderdate between '2017-01-01' and '2017-12-31'
                       ) dt  
                    group by mm , orderdate
    ) as dt 
    
    --120
    
    ë¬¸ì œ10ë²ˆ) ì£¼ë¬¸ì„ ë§ì´ í•œ ê³ ê° ìˆœì„œ ëŒ€ë¡œ ìˆœìœ„ë¥¼ ë§¤ê²¨ ë‚˜ì—´í•˜ì„¸ìš”. (analytic function í™œìš©) 
    - ê°™ì€ ì£¼ë¬¸ ìˆ˜ì¹˜ ì¼ ë•Œ, ê°™ì€ ë“±ìˆ˜ë¡œ ë³´ì—¬ì£¼ì„¸ìš”.
    
    select  c.custfirstname || c.custlastname as cust_name  , o.customerid , order_cnt , 
                    DENSE_RANK() over(order by order_cnt  desc) drnk ,
                    rank () over(order by order_cnt  desc) rnk ,
                    row_number () over(order by order_cnt  desc) rnum 
    from 
    (
      select o.customerid  , count(*) order_cnt 
        from orders as o 
       group by o.customerid 
    ) o inner join customers as c on c.customerid = o.customerid
    ```
    
- ì¶”ê°€ë¬¸ì œ
    1. í•´ì»¤ë­í¬ ì­‰ í’€ì–´ë³´ì‹œë©´ ë©ë‹ˆë‹¤ ! 
    
    [https://www.hackerrank.com/domains/sql](https://www.hackerrank.com/domains/sql)
    
    1. DatacampëŠ” ìœ ë£Œ,,,, 

---

---

- ì¿¼ë¦¬ë¬¸ (ì´ì˜ê²Œ) ì •ë ¬ í•´ì£¼ëŠ” ì‚¬ì´íŠ¸ - Format SQL click
    
    [https://www.dpriver.com/pp/sqlformat.htm](https://www.dpriver.com/pp/sqlformat.htm)
    

# ì°¸ê³ ìë£Œ

- ì°¸ê³ ìë£Œ
    
    [https://www.slideshare.net/zzsza/bigquery-147073606](https://www.slideshare.net/zzsza/bigquery-147073606)
    
    - ê°€ì¥ ì¤‘ìš”í•œ ë°ì´í„°ëŠ” ì´ë¯¸ ë‚´ë¶€ì— ìˆë‹¤
    
    [https://publy.co/content/433?utm_source=brunch_minu&utm_medium=brunch_minu&utm_content=data_sql](https://publy.co/content/433?utm_source=brunch_minu&utm_medium=brunch_minu&utm_content=data_sql) 
    
    - ë°ì´í„° ë¶„ì„, SQLë§Œ ì˜ ë‹¤ë¤„ë„ ë¨¹ê³  ë“¤ì–´ê°‘ë‹ˆë‹¤.
    
    [https://brunch.co.kr/@minu-log/4](https://brunch.co.kr/@minu-log/4)
    
    - ë°ì´í„° ë¶„ì„, ë¨¹ê³  ë“¤ì–´ê°€ê¸° ìœ„í•œ SQL ê³µë¶€ë²•(1í¸)
    
    [https://brunch.co.kr/@minu-log/5](https://brunch.co.kr/@minu-log/5)
    

---

---

- SQL ë°°ìš°ê¸°
    - [SQL ë ˆë²¨ì—…](http://www.yes24.com/24/goods/24089836?scode=032&OzSrank=2)Â : SQL ê¸°ì´ˆ ê³µë¶€
    - [ë°ì´í„° ë¶„ì„ì„ ìœ„í•œ SQL ë ˆì‹œí”¼](http://www.yes24.com/24/goods/59411396?scode=032&OzSrank=1)Â : SQL ì‹¬í™” ê³µë¶€!  ì‹¤ë¬´ì—ì„œ í™œìš©í•œ ë‚´ìš© ê°€ë“ (ì´ë¼ê³  í•˜ì‹œë„¤ìš”)

[[á„†á…®á„…á…­á„Œá…¥á†«á„Œá…¡á„á…¢á†¨] á„‹á…µá„€á…§á†¼á„‹á…©á„‹á…´ SQL+SQLD á„‡á…µá„†á…µá†¯á„‚á…©á„á…³.pdf](S%20Q%20L%20652a8da88475490c9583cc1c305da234/%E1%84%86%E1%85%AE%E1%84%85%E1%85%AD%E1%84%8C%E1%85%A5%E1%86%AB%E1%84%8C%E1%85%A1%E1%84%8E%E1%85%A2%E1%86%A8_%E1%84%8B%E1%85%B5%E1%84%80%E1%85%A7%E1%86%BC%E1%84%8B%E1%85%A9%E1%84%8B%E1%85%B4_SQLSQLD_%E1%84%87%E1%85%B5%E1%84%86%E1%85%B5%E1%86%AF%E1%84%82%E1%85%A9%E1%84%90%E1%85%B3.pdf)